2022-04-25 18:21:38,445 - multiprocessing - INFO - Starting __main__
2022-04-25 18:21:38,445 - multiprocessing - INFO - Connecting to Oracle...
2022-04-25 18:21:40,231 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x000001DD7D48C760>, <jaydebeapi.Cursor object at 0x000001DD7D48C5E0>)
2022-04-25 18:21:40,815 - multiprocessing - INFO - Connection closed
2022-04-25 18:21:40,826 - multiprocessing - INFO - process shutting down
2022-04-25 18:22:18,024 - multiprocessing - INFO - Starting __main__
2022-04-25 18:22:18,024 - multiprocessing - INFO - Connecting to Oracle...
2022-04-25 18:22:19,634 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x000001F7FEDEC790>, <jaydebeapi.Cursor object at 0x000001F7FEDEC610>)
2022-04-25 18:22:20,163 - multiprocessing - INFO - Connection closed
2022-04-25 18:22:20,174 - multiprocessing - INFO - process shutting down
2022-04-26 14:54:29,589 - multiprocessing - INFO - Starting __main__
2022-04-26 14:54:29,589 - multiprocessing - INFO - Connecting to Oracle...
2022-04-26 14:54:31,778 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x000002064C09C580>, <jaydebeapi.Cursor object at 0x000002064C09C430>)
2022-04-26 14:54:31,813 - multiprocessing - INFO - process shutting down
2022-04-26 14:54:57,765 - multiprocessing - INFO - Starting __main__
2022-04-26 14:54:57,765 - multiprocessing - INFO - Connecting to Oracle...
2022-04-26 14:54:59,279 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x0000025AD469C430>, <jaydebeapi.Cursor object at 0x0000025AD469C580>)
2022-04-26 14:54:59,478 - multiprocessing - INFO - Connection closed
2022-04-26 14:54:59,500 - multiprocessing - INFO - process shutting down
2022-04-26 14:55:37,629 - multiprocessing - INFO - Starting __main__
2022-04-26 14:55:37,629 - multiprocessing - INFO - Connecting to Oracle...
2022-04-26 14:55:39,042 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x0000021DDCBD96D0>, <jaydebeapi.Cursor object at 0x0000021DDCBD9550>)
2022-04-26 14:55:39,449 - multiprocessing - INFO - Connection closed
2022-04-26 14:55:39,461 - multiprocessing - INFO - process shutting down
2022-04-26 14:57:43,337 - multiprocessing - INFO - Starting __main__
2022-04-26 14:57:43,337 - multiprocessing - INFO - Connecting to Oracle...
2022-04-26 14:57:44,847 - multiprocessing - INFO - Connected! Params: (<jaydebeapi.Connection object at 0x000001B9F82B6970>, <jaydebeapi.Cursor object at 0x000001B9F82B67F0>)
2022-04-26 14:57:45,098 - multiprocessing - INFO - process shutting down
2022-04-30 10:35:41,646 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 10:35:41,646 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 10:35:41,647 - multiprocessing - INFO - Connected! Params: conn
2022-04-30 10:35:41,647 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 10:35:41,665 - multiprocessing - INFO - process shutting down
2022-04-30 10:37:46,965 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 10:37:46,966 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 10:37:46,966 - multiprocessing - INFO - Connected! Params: conn
2022-04-30 10:37:46,966 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 10:37:46,968 - multiprocessing - INFO - process shutting down
2022-04-30 10:38:14,371 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 10:38:14,371 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 10:38:14,372 - multiprocessing - INFO - Connected! Params: conn
2022-04-30 10:38:14,373 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 10:38:14,373 - multiprocessing - INFO - Connection closed
2022-04-30 10:38:14,374 - multiprocessing - INFO - process shutting down
2022-04-30 11:01:59,375 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:01:59,376 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:01:59,377 - multiprocessing - INFO - Connected! Params: conn
2022-04-30 11:01:59,377 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 11:01:59,378 - multiprocessing - INFO - Connection closed
2022-04-30 11:01:59,378 - multiprocessing - INFO - process shutting down
2022-04-30 11:28:02,694 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:28:02,695 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:28:03,074 - multiprocessing - INFO - Setting connection failed with Exception: No JVM shared library file (jvm.dll) found. Try setting up the JAVA_HOME environment variable properly.
2022-04-30 11:28:03,079 - multiprocessing - INFO - process shutting down
2022-04-30 11:30:22,774 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:30:22,774 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:30:22,775 - multiprocessing - INFO - process shutting down
2022-04-30 11:31:24,534 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:31:24,534 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:31:24,536 - multiprocessing - INFO - process shutting down
2022-04-30 11:32:17,833 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:32:17,833 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:32:17,879 - multiprocessing - INFO - Setting connection failed with Exception: No JVM shared library file (jvm.dll) found. Try setting up the JAVA_HOME environment variable properly.
2022-04-30 11:32:17,883 - multiprocessing - INFO - process shutting down
2022-04-30 11:35:54,721 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:35:54,721 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:35:54,980 - multiprocessing - INFO - Setting connection failed with Exception: No JVM shared library file (jvm.dll) found. Try setting up the JAVA_HOME environment variable properly.
2022-04-30 11:35:54,985 - multiprocessing - INFO - process shutting down
2022-04-30 11:39:33,630 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:39:33,630 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:39:33,880 - multiprocessing - INFO - Setting connection failed with Exception: No JVM shared library file (jvm.dll) found. Try setting up the JAVA_HOME environment variable properly.
2022-04-30 11:39:33,883 - multiprocessing - INFO - process shutting down
2022-04-30 11:49:52,760 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:49:52,761 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:49:58,469 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C582DA5B70>
2022-04-30 11:49:58,469 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C582DA5B70> by query: select 1 from DUAL
2022-04-30 11:49:58,470 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C582DA5B70> is broken with Exception 'Connection' object has no attribute 'get_cursor'
2022-04-30 11:49:58,471 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 11:49:58,517 - multiprocessing - INFO - Connection closed
2022-04-30 11:49:58,577 - multiprocessing - INFO - process shutting down
2022-04-30 11:51:11,452 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:51:11,452 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:51:15,184 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000226856BDBA0>
2022-04-30 11:51:15,184 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000226856BDBA0> by query: select 1 from DUAL
2022-04-30 11:51:16,153 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000226856BDBA0> successfully checked
2022-04-30 11:51:16,153 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 11:51:16,266 - multiprocessing - INFO - Connection closed
2022-04-30 11:51:16,345 - multiprocessing - INFO - process shutting down
2022-04-30 11:52:11,047 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 11:52:11,048 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 11:52:14,954 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001D510DA5B70>
2022-04-30 11:52:14,954 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001D510DA5B70> by query: select 1 from DUAL
2022-04-30 11:52:16,515 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001D510DA5B70> successfully checked
2022-04-30 11:52:16,515 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 11:52:16,517 - multiprocessing - INFO - ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 11:52:16,540 - multiprocessing - INFO - Connection closed
2022-04-30 11:52:16,555 - multiprocessing - INFO - process shutting down
2022-04-30 12:09:11,762 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 12:09:11,763 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 12:09:15,134 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BC0E335B70>
2022-04-30 12:09:15,134 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BC0E335B70> by query: select 1 from DUAL
2022-04-30 12:09:15,831 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BC0E335B70> successfully checked
2022-04-30 12:09:15,831 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 12:09:15,833 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 12:09:15,853 - multiprocessing - INFO - Connection closed
2022-04-30 12:09:15,867 - multiprocessing - INFO - process shutting down
2022-04-30 12:16:40,314 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 12:16:40,315 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 12:16:44,119 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000023617435B40>
2022-04-30 12:16:44,119 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000023617435B40> by query: select 1 from DUAL
2022-04-30 12:16:45,223 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000023617435B40> successfully checked
2022-04-30 12:16:45,224 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 12:16:45,225 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 12:16:45,386 - multiprocessing - INFO - process shutting down
2022-04-30 12:17:29,398 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 12:17:29,399 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 12:17:33,406 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A27C095B40>
2022-04-30 12:17:33,407 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A27C095B40> by query: select 1 from DUAL
2022-04-30 12:17:33,982 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A27C095B40> successfully checked
2022-04-30 12:17:33,982 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 12:17:33,983 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 12:17:34,031 - multiprocessing - INFO - process shutting down
2022-04-30 12:18:30,393 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 12:18:30,393 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 12:18:33,440 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000275B9405B40>
2022-04-30 12:18:33,440 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000275B9405B40> by query: select 1 from DUAL
2022-04-30 12:18:33,838 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000275B9405B40> successfully checked
2022-04-30 12:18:33,838 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 12:18:33,839 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 12:18:33,940 - multiprocessing - INFO - process shutting down
2022-04-30 12:21:49,239 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 12:21:49,239 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 12:21:52,026 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002AB121F9B40>
2022-04-30 12:21:52,026 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002AB121F9B40> by query: select 1 from DUAL
2022-04-30 12:21:52,453 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002AB121F9B40> successfully checked
2022-04-30 12:21:52,453 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 12:21:52,454 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 12:21:53,883 - multiprocessing - INFO -     terminal_id  ...                              terminal_address
0         A1096  ...  г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099  ...          г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203  ...    г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553  ...            г. Воронеж, пр. Энтузиастов, д. 44
4         A1641  ...        г. Москва, 1-й Южнопортовый пр., д. 26
..          ...  ...                                           ...
145       P9862  ...     г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889  ...               г. Усмань, Шушенская ул., д. 14
147       P9974  ...                   г. Томск, ул. Шухова, д. 22
148       P9977  ...    г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978  ...          г. Знаменск, Электролитный пр., д. 5

[150 rows x 4 columns]
2022-04-30 12:21:53,967 - multiprocessing - INFO - Connection closed
2022-04-30 12:21:53,990 - multiprocessing - INFO - process shutting down
2022-04-30 13:52:40,656 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 13:52:40,657 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 13:52:43,558 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001DC1A0B9B40>
2022-04-30 13:52:43,559 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001DC1A0B9B40> by query: select 1 from DUAL
2022-04-30 13:52:44,205 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001DC1A0B9B40> successfully checked
2022-04-30 13:52:44,206 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 13:52:44,207 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 13:52:44,223 - multiprocessing - INFO - Connection closed
2022-04-30 13:52:44,260 - multiprocessing - INFO - process shutting down
2022-04-30 13:56:47,910 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 13:56:47,910 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 13:56:50,955 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000018428D09B40>
2022-04-30 13:56:50,955 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000018428D09B40> by query: select 1 from DUAL
2022-04-30 13:56:51,471 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000018428D09B40> successfully checked
2022-04-30 13:56:51,472 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 13:56:51,473 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 13:56:51,526 - multiprocessing - INFO - process shutting down
2022-04-30 13:57:28,014 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 13:57:28,015 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 13:57:31,494 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002212D799B40>
2022-04-30 13:57:31,494 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002212D799B40> by query: select 1 from DUAL
2022-04-30 13:57:32,243 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002212D799B40> successfully checked
2022-04-30 13:57:32,243 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 13:57:32,244 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 13:57:32,304 - multiprocessing - INFO - Connection closed
2022-04-30 13:57:32,522 - multiprocessing - INFO - process shutting down
2022-04-30 14:00:15,304 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:00:15,304 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:00:18,214 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024049BD5B40>
2022-04-30 14:00:18,214 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024049BD5B40> by query: select 1 from DUAL
2022-04-30 14:00:18,604 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024049BD5B40> successfully checked
2022-04-30 14:00:18,604 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:00:18,605 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:00:18,658 - multiprocessing - INFO - process shutting down
2022-04-30 14:00:51,199 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:00:51,199 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:00:54,202 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002A201919B40>
2022-04-30 14:00:54,202 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002A201919B40> by query: select 1 from DUAL
2022-04-30 14:00:54,737 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002A201919B40> successfully checked
2022-04-30 14:00:54,738 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:00:54,739 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:00:54,790 - multiprocessing - INFO - process shutting down
2022-04-30 14:02:03,656 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:02:03,657 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:02:06,623 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000029B27DB9B40>
2022-04-30 14:02:06,623 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000029B27DB9B40> by query: select 1 from DUAL
2022-04-30 14:02:07,068 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000029B27DB9B40> successfully checked
2022-04-30 14:02:07,069 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:02:07,070 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:02:07,108 - multiprocessing - INFO - process shutting down
2022-04-30 14:03:17,886 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:03:17,886 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:03:20,932 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000027CD7CF9B40>
2022-04-30 14:03:20,932 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000027CD7CF9B40> by query: select 1 from DUAL
2022-04-30 14:03:21,327 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000027CD7CF9B40> successfully checked
2022-04-30 14:03:21,327 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:03:21,328 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:03:21,387 - multiprocessing - INFO - process shutting down
2022-04-30 14:04:50,320 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:04:50,320 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:04:54,239 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000020217069B40>
2022-04-30 14:04:54,239 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000020217069B40> by query: select 1 from DUAL
2022-04-30 14:04:55,054 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000020217069B40> successfully checked
2022-04-30 14:04:55,054 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:04:55,055 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:04:55,164 - multiprocessing - INFO - process shutting down
2022-04-30 14:05:24,329 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:05:24,329 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:05:27,319 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000238C08A9B40>
2022-04-30 14:05:27,319 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000238C08A9B40> by query: select 1 from DUAL
2022-04-30 14:05:27,707 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000238C08A9B40> successfully checked
2022-04-30 14:05:27,707 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:05:27,708 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:05:27,762 - multiprocessing - INFO - process shutting down
2022-04-30 14:10:50,786 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:10:50,787 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:10:53,753 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BD27115B40>
2022-04-30 14:10:53,753 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BD27115B40> by query: select 1 from DUAL
2022-04-30 14:10:54,175 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BD27115B40> successfully checked
2022-04-30 14:10:54,175 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:10:54,176 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:10:54,212 - multiprocessing - INFO - process shutting down
2022-04-30 14:11:08,453 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:11:08,453 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:11:11,573 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000228CCCF9B40>
2022-04-30 14:11:11,573 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000228CCCF9B40> by query: select 1 from DUAL
2022-04-30 14:11:12,002 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000228CCCF9B40> successfully checked
2022-04-30 14:11:12,003 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:11:12,003 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:11:12,068 - multiprocessing - INFO - process shutting down
2022-04-30 14:12:15,263 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:12:15,263 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:12:18,562 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000019563B59B40>
2022-04-30 14:12:18,563 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000019563B59B40> by query: select 1 from DUAL
2022-04-30 14:12:19,379 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000019563B59B40> successfully checked
2022-04-30 14:12:19,379 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:12:19,386 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:12:19,489 - multiprocessing - INFO - process shutting down
2022-04-30 14:12:50,438 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:12:50,438 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:12:50,439 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:12:50,439 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:12:50,441 - multiprocessing - INFO - process shutting down
2022-04-30 14:13:03,601 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:13:03,601 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:13:03,601 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:13:03,602 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:13:03,607 - multiprocessing - INFO - process shutting down
2022-04-30 14:13:51,286 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:13:51,286 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:13:51,286 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:13:51,287 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:13:51,293 - multiprocessing - INFO - process shutting down
2022-04-30 14:14:32,255 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:14:32,255 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:14:32,255 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:14:32,256 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:14:32,261 - multiprocessing - INFO - process shutting down
2022-04-30 14:15:00,676 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:15:00,677 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:15:00,677 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:15:00,678 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:15:01,234 - multiprocessing - INFO - process shutting down
2022-04-30 14:15:11,099 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:15:11,099 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:15:11,100 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:15:11,100 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:15:11,645 - multiprocessing - INFO - Connection closed
2022-04-30 14:15:11,645 - multiprocessing - INFO - process shutting down
2022-04-30 14:18:44,526 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:18:44,527 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:18:44,527 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:18:44,527 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:18:45,075 - multiprocessing - INFO - Connection closed
2022-04-30 14:18:45,075 - multiprocessing - INFO - process shutting down
2022-04-30 14:19:08,108 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:19:08,109 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:19:08,109 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:19:08,110 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:19:08,674 - multiprocessing - INFO - process shutting down
2022-04-30 14:19:17,139 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:19:17,139 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:19:17,139 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:19:17,140 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:19:17,747 - multiprocessing - INFO - Connection closed
2022-04-30 14:19:17,747 - multiprocessing - INFO - process shutting down
2022-04-30 14:20:06,892 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:20:06,893 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:20:06,893 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:20:06,893 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:20:07,457 - multiprocessing - INFO - Connection closed
2022-04-30 14:20:07,457 - multiprocessing - INFO - process shutting down
2022-04-30 14:24:37,738 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:24:37,738 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:24:37,738 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:24:37,738 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:24:38,347 - multiprocessing - INFO - process shutting down
2022-04-30 14:26:30,042 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:26:30,042 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:26:30,042 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:26:30,042 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:26:30,058 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx for the date 2021-03-03 00:00:00
2022-04-30 14:26:30,589 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:26:30,605 - multiprocessing - INFO -     terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:26:30,621 - multiprocessing - INFO - Connection closed
2022-04-30 14:26:30,621 - multiprocessing - INFO - process shutting down
2022-04-30 14:27:04,760 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:27:04,760 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:27:04,760 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:27:04,760 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:27:04,760 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:27:05,338 - multiprocessing - INFO -     terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:27:05,354 - multiprocessing - INFO - Connection closed
2022-04-30 14:27:05,354 - multiprocessing - INFO - process shutting down
2022-04-30 14:27:23,472 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:27:23,472 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:27:23,472 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:27:23,472 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:27:23,488 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:27:24,207 - multiprocessing - INFO - Created dataframe:

2022-04-30 14:27:24,207 - multiprocessing - INFO -     terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:27:24,222 - multiprocessing - INFO - Connection closed
2022-04-30 14:27:24,222 - multiprocessing - INFO - process shutting down
2022-04-30 14:27:49,797 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:27:49,797 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:27:49,812 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:27:49,812 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:27:49,812 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:27:50,422 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:27:50,422 - multiprocessing - INFO - 
df.to_string()
2022-04-30 14:27:50,422 - multiprocessing - INFO - Connection closed
2022-04-30 14:27:50,422 - multiprocessing - INFO - process shutting down
2022-04-30 14:28:12,164 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:28:12,164 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:28:12,164 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:28:12,164 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:28:12,164 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:28:12,727 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:28:12,742 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:28:12,758 - multiprocessing - INFO - Connection closed
2022-04-30 14:28:12,758 - multiprocessing - INFO - process shutting down
2022-04-30 14:50:59,096 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:50:59,096 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:50:59,190 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 14:50:59,190 - multiprocessing - INFO - Checking connection: None by query: select 1 from DUAL
2022-04-30 14:50:59,190 - multiprocessing - INFO - Connection None is broken with Exception 'NoneType' object has no attribute 'cursor'
2022-04-30 14:50:59,190 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:50:59,190 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:50:59,206 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:50:59,753 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:50:59,753 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:50:59,768 - multiprocessing - INFO - process shutting down
2022-04-30 14:51:23,961 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:51:23,961 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:51:23,992 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 14:51:23,992 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:51:23,992 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:51:23,992 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:51:24,508 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:51:24,523 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:51:24,539 - multiprocessing - INFO - process shutting down
2022-04-30 14:51:44,564 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:51:44,564 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:51:44,595 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 14:51:44,595 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:51:44,595 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:51:44,595 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:51:45,111 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:51:45,127 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:51:45,142 - multiprocessing - INFO - process shutting down
2022-04-30 14:52:23,517 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 14:52:23,517 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 14:52:23,549 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 14:52:23,549 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 14:52:23,549 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 14:52:23,549 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 14:52:24,132 - multiprocessing - INFO - Created dataframe:
2022-04-30 14:52:24,132 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 14:52:24,148 - multiprocessing - INFO - process shutting down
2022-04-30 15:09:00,755 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:09:00,755 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:09:00,849 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 15:09:00,849 - multiprocessing - INFO - Checking connection: None by query: select 1 from DUAL
2022-04-30 15:09:00,849 - multiprocessing - INFO - Connection None is broken with Exception 'NoneType' object has no attribute 'cursor'
2022-04-30 15:09:00,849 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:09:00,849 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:09:00,864 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:09:02,790 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:09:02,852 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:09:02,868 - multiprocessing - INFO - process shutting down
2022-04-30 15:12:49,498 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:12:49,498 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:12:49,514 - multiprocessing - INFO - Connection failed with Exception: (cx_Oracle.DatabaseError) DPI-1047: Cannot locate a 64-bit Oracle Client library: "The specified module could not be found". See https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html for help
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2022-04-30 15:12:49,514 - multiprocessing - INFO - Checking connection: None by query: select 1 from DUAL
2022-04-30 15:12:49,514 - multiprocessing - INFO - Connection None is broken with Exception 'NoneType' object has no attribute 'cursor'
2022-04-30 15:12:49,514 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:12:49,530 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:12:49,530 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:12:50,045 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:12:50,061 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:12:50,077 - multiprocessing - INFO - process shutting down
2022-04-30 15:13:25,611 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:13:25,611 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:13:25,611 - multiprocessing - INFO - process shutting down
2022-04-30 15:13:56,192 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:13:56,192 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:13:59,562 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000231F511A830>
2022-04-30 15:13:59,562 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000231F511A830> by query: select 1 from DUAL
2022-04-30 15:14:00,015 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000231F511A830> successfully checked
2022-04-30 15:14:00,015 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:14:00,015 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:14:00,015 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:14:00,702 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:14:00,718 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:14:00,833 - multiprocessing - INFO - process shutting down
2022-04-30 15:17:52,287 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:17:52,287 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:17:55,233 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000023CFAAEE830>
2022-04-30 15:17:55,233 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000023CFAAEE830> by query: select 1 from DUAL
2022-04-30 15:17:55,671 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000023CFAAEE830> successfully checked
2022-04-30 15:17:55,671 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:17:55,687 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:17:55,687 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:17:56,608 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:17:56,624 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:17:56,983 - multiprocessing - INFO - Connection closed
2022-04-30 15:17:57,006 - multiprocessing - INFO - process shutting down
2022-04-30 15:19:19,756 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:19:19,756 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:19:22,651 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002A203A7A860>
2022-04-30 15:19:22,651 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002A203A7A860> by query: select 1 from DUAL
2022-04-30 15:19:23,125 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002A203A7A860> successfully checked
2022-04-30 15:19:23,125 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:19:23,125 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:19:23,125 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:19:23,890 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:19:23,906 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:19:23,922 - multiprocessing - INFO - Data was inserted!
2022-04-30 15:19:23,937 - multiprocessing - INFO - Connection closed
2022-04-30 15:19:23,958 - multiprocessing - INFO - process shutting down
2022-04-30 15:22:46,894 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:22:46,894 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:22:49,908 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001D1428AE860>
2022-04-30 15:22:49,908 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001D1428AE860> by query: select 1 from DUAL
2022-04-30 15:22:50,627 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001D1428AE860> successfully checked
2022-04-30 15:22:50,627 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:22:50,627 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:22:50,658 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:22:51,221 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:22:51,236 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:22:51,252 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.SQLException: В индексе отсутствует параметр IN или OUT:: 5
2022-04-30 15:22:51,268 - multiprocessing - INFO - Connection closed
2022-04-30 15:22:51,285 - multiprocessing - INFO - process shutting down
2022-04-30 15:24:07,014 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:24:07,014 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:24:10,134 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021CD968A860>
2022-04-30 15:24:10,134 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021CD968A860> by query: select 1 from DUAL
2022-04-30 15:24:10,775 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021CD968A860> successfully checked
2022-04-30 15:24:10,775 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:24:10,775 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:24:10,775 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:24:11,478 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:24:11,493 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:24:11,525 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.SQLException: В индексе отсутствует параметр IN или OUT:: 5
2022-04-30 15:24:11,540 - multiprocessing - INFO - Connection closed
2022-04-30 15:24:11,602 - multiprocessing - INFO - process shutting down
2022-04-30 15:24:58,138 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:24:58,138 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:25:01,305 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002470200A860>
2022-04-30 15:25:01,305 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002470200A860> by query: select 1 from DUAL
2022-04-30 15:25:01,758 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002470200A860> successfully checked
2022-04-30 15:25:01,758 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:25:01,758 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:25:01,774 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:25:02,602 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:25:02,618 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:25:02,758 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-12899: значение для столбца "DEMIPT2"."GOLD_STG_DIM_TERMINALS"."TERMINAL_CITY" слишком велико (фактическое: 22, максимальное: 20)

2022-04-30 15:25:02,774 - multiprocessing - INFO - Connection closed
2022-04-30 15:25:02,795 - multiprocessing - INFO - process shutting down
2022-04-30 15:26:23,103 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:26:23,103 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:26:26,262 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001E00240E830>
2022-04-30 15:26:26,262 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001E00240E830> by query: select 1 from DUAL
2022-04-30 15:26:26,715 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001E00240E830> successfully checked
2022-04-30 15:26:26,715 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:26:26,715 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:26:26,715 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:26:27,559 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:26:27,574 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:26:27,840 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-12899: значение для столбца "DEMIPT2"."GOLD_STG_DIM_TERMINALS"."TERMINAL_CITY" слишком велико (фактическое: 33, максимальное: 30)

2022-04-30 15:26:27,856 - multiprocessing - INFO - Connection closed
2022-04-30 15:26:27,878 - multiprocessing - INFO - process shutting down
2022-04-30 15:29:13,084 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:29:13,084 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:29:15,957 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001CBB357E830>
2022-04-30 15:29:15,957 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001CBB357E830> by query: select 1 from DUAL
2022-04-30 15:29:16,441 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001CBB357E830> successfully checked
2022-04-30 15:29:16,457 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:29:16,457 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:29:16,457 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:29:17,378 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:29:17,394 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:29:17,550 - multiprocessing - INFO - Data was inserted!
2022-04-30 15:29:17,550 - multiprocessing - INFO - Connection closed
2022-04-30 15:29:17,575 - multiprocessing - INFO - process shutting down
2022-04-30 15:42:38,303 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:42:38,303 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:42:41,551 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022BA510E860>
2022-04-30 15:42:41,551 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022BA510E860> by query: select 1 from DUAL
2022-04-30 15:42:42,176 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022BA510E860> successfully checked
2022-04-30 15:42:42,176 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:42:42,176 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:42:42,192 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:42:42,933 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:42:42,949 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:42:42,965 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:42:42,980 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.SQLException: В индексе отсутствует параметр IN или OUT:: 5
2022-04-30 15:42:42,996 - multiprocessing - INFO - Connection closed
2022-04-30 15:42:43,013 - multiprocessing - INFO - process shutting down
2022-04-30 15:43:06,675 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:43:06,675 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:43:11,580 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021C94A1A860>
2022-04-30 15:43:11,580 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021C94A1A860> by query: select 1 from DUAL
2022-04-30 15:43:12,345 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021C94A1A860> successfully checked
2022-04-30 15:43:12,345 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:43:12,345 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:43:12,345 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:43:14,183 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:43:14,199 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:43:14,215 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:43:14,308 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-01861: литерал не соответствует формату строки

2022-04-30 15:43:14,324 - multiprocessing - INFO - Connection closed
2022-04-30 15:43:14,630 - multiprocessing - INFO - process shutting down
2022-04-30 15:44:35,177 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:44:35,177 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:44:38,077 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022A221EA860>
2022-04-30 15:44:38,077 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022A221EA860> by query: select 1 from DUAL
2022-04-30 15:44:38,592 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022A221EA860> successfully checked
2022-04-30 15:44:38,592 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:44:38,592 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:44:38,592 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:44:39,170 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:44:39,186 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:44:39,202 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:44:39,248 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-01861: литерал не соответствует формату строки

2022-04-30 15:44:39,264 - multiprocessing - INFO - Connection closed
2022-04-30 15:44:39,288 - multiprocessing - INFO - process shutting down
2022-04-30 15:44:56,598 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:44:56,598 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:44:59,756 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002481407E860>
2022-04-30 15:44:59,756 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002481407E860> by query: select 1 from DUAL
2022-04-30 15:45:00,224 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002481407E860> successfully checked
2022-04-30 15:45:00,224 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:45:00,224 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:45:00,224 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:45:00,959 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:45:00,974 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:45:00,990 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:45:01,099 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-01861: литерал не соответствует формату строки

2022-04-30 15:45:01,099 - multiprocessing - INFO - Connection closed
2022-04-30 15:45:01,154 - multiprocessing - INFO - process shutting down
2022-04-30 15:45:15,694 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:45:15,694 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:45:18,642 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000110236CA860>
2022-04-30 15:45:18,642 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000110236CA860> by query: select 1 from DUAL
2022-04-30 15:45:19,126 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000110236CA860> successfully checked
2022-04-30 15:45:19,126 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:45:19,126 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:45:19,126 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:45:19,970 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:45:19,985 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:45:20,001 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:45:20,017 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.SQLException: В индексе отсутствует параметр IN или OUT:: 5
2022-04-30 15:45:20,032 - multiprocessing - INFO - Connection closed
2022-04-30 15:45:20,064 - multiprocessing - INFO - process shutting down
2022-04-30 15:45:50,041 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:45:50,041 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:45:52,898 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000173242CA860>
2022-04-30 15:45:52,898 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000173242CA860> by query: select 1 from DUAL
2022-04-30 15:45:53,383 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000173242CA860> successfully checked
2022-04-30 15:45:53,383 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:45:53,398 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:45:53,398 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:45:54,070 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:45:54,086 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:45:54,133 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:45:54,242 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-00917: отсутствует запятая

2022-04-30 15:45:54,258 - multiprocessing - INFO - Connection closed
2022-04-30 15:45:54,298 - multiprocessing - INFO - process shutting down
2022-04-30 15:46:15,794 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:46:15,794 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:46:19,025 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000018C19D2A860>
2022-04-30 15:46:19,025 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000018C19D2A860> by query: select 1 from DUAL
2022-04-30 15:46:19,557 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000018C19D2A860> successfully checked
2022-04-30 15:46:19,557 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:46:19,557 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:46:19,557 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:46:20,353 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:46:20,369 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:46:20,385 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:46:20,385 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.SQLException: В индексе отсутствует параметр IN или OUT:: 5
2022-04-30 15:46:20,400 - multiprocessing - INFO - Connection closed
2022-04-30 15:46:20,416 - multiprocessing - INFO - process shutting down
2022-04-30 15:46:31,821 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:46:31,821 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:46:36,213 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002D2B69AA860>
2022-04-30 15:46:36,213 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002D2B69AA860> by query: select 1 from DUAL
2022-04-30 15:46:36,790 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002D2B69AA860> successfully checked
2022-04-30 15:46:36,790 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:46:36,792 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:46:36,797 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:46:38,461 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:46:38,482 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:46:38,560 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:46:38,616 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-01861: литерал не соответствует формату строки

2022-04-30 15:46:38,639 - multiprocessing - INFO - Connection closed
2022-04-30 15:46:38,680 - multiprocessing - INFO - process shutting down
2022-04-30 15:47:34,998 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:47:34,998 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:47:38,748 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001703A5EA860>
2022-04-30 15:47:38,748 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001703A5EA860> by query: select 1 from DUAL
2022-04-30 15:47:39,576 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001703A5EA860> successfully checked
2022-04-30 15:47:39,576 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:47:39,576 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:47:39,591 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:47:40,466 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:47:40,498 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:47:40,513 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:47:40,638 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-01830: шаблон формата даты завершается перед преобразованием всей строки ввода

2022-04-30 15:47:40,654 - multiprocessing - INFO - Connection closed
2022-04-30 15:47:40,828 - multiprocessing - INFO - process shutting down
2022-04-30 15:48:02,876 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:48:02,876 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:48:05,716 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002725396E860>
2022-04-30 15:48:05,716 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002725396E860> by query: select 1 from DUAL
2022-04-30 15:48:06,184 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002725396E860> successfully checked
2022-04-30 15:48:06,184 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:48:06,184 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:48:06,184 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:48:06,903 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:48:06,903 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:48:06,934 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:48:06,966 - multiprocessing - INFO - Data was inserted!
2022-04-30 15:48:06,981 - multiprocessing - INFO - Connection closed
2022-04-30 15:48:07,002 - multiprocessing - INFO - process shutting down
2022-04-30 15:53:19,437 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:53:19,437 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:53:22,376 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021DD4A3A860>
2022-04-30 15:53:22,376 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021DD4A3A860> by query: select 1 from DUAL
2022-04-30 15:53:22,845 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021DD4A3A860> successfully checked
2022-04-30 15:53:22,845 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:53:22,845 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:53:22,860 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:53:23,751 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:53:23,751 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:53:23,767 - multiprocessing - INFO - Staging was cleared!
2022-04-30 15:53:23,829 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-00933: неверное завершение SQL-предложения

2022-04-30 15:53:23,845 - multiprocessing - INFO - Connection closed
2022-04-30 15:53:23,864 - multiprocessing - INFO - process shutting down
2022-04-30 15:55:31,252 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 15:55:31,252 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 15:55:34,426 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000192C02FE860>
2022-04-30 15:55:34,426 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000192C02FE860> by query: select 1 from DUAL
2022-04-30 15:55:35,035 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000192C02FE860> successfully checked
2022-04-30 15:55:35,035 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 15:55:35,035 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 15:55:35,035 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 15:55:35,848 - multiprocessing - INFO - Created dataframe:
2022-04-30 15:55:35,848 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 15:55:35,930 - multiprocessing - INFO - process shutting down
2022-04-30 16:01:50,024 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:01:50,024 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:01:53,005 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000014A5BAAA860>
2022-04-30 16:01:53,005 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000014A5BAAA860> by query: select 1 from DUAL
2022-04-30 16:01:53,645 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000014A5BAAA860> successfully checked
2022-04-30 16:01:53,645 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:01:53,645 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:01:53,645 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:01:54,317 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:01:54,317 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:01:54,333 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:01:54,364 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:01:54,380 - multiprocessing - INFO - Connection closed
2022-04-30 16:01:54,415 - multiprocessing - INFO - process shutting down
2022-04-30 16:02:28,787 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:02:28,787 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:02:33,668 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002B62D75E860>
2022-04-30 16:02:33,668 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002B62D75E860> by query: select 1 from DUAL
2022-04-30 16:02:34,152 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002B62D75E860> successfully checked
2022-04-30 16:02:34,152 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:02:34,152 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:02:34,168 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:02:34,373 - multiprocessing - INFO - process shutting down
2022-04-30 16:02:46,550 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:02:46,550 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:02:50,200 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001FBE573E860>
2022-04-30 16:02:50,200 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001FBE573E860> by query: select 1 from DUAL
2022-04-30 16:02:51,294 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001FBE573E860> successfully checked
2022-04-30 16:02:51,294 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:02:51,294 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:02:51,310 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:02:52,044 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:02:52,060 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:02:52,075 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:02:52,122 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:02:52,154 - multiprocessing - INFO - Connection closed
2022-04-30 16:02:52,181 - multiprocessing - INFO - process shutting down
2022-04-30 16:04:46,470 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:04:46,470 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:04:49,312 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002232AFEA830>
2022-04-30 16:04:49,312 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002232AFEA830> by query: select 1 from DUAL
2022-04-30 16:04:49,796 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002232AFEA830> successfully checked
2022-04-30 16:04:49,796 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:04:49,796 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:04:49,796 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:04:50,593 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:04:50,608 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:04:50,624 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:04:50,671 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:04:50,718 - multiprocessing - INFO - Connection closed
2022-04-30 16:04:50,739 - multiprocessing - INFO - process shutting down
2022-04-30 16:05:19,033 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:05:19,033 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:05:22,114 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002022193E860>
2022-04-30 16:05:22,114 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002022193E860> by query: select 1 from DUAL
2022-04-30 16:05:22,583 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002022193E860> successfully checked
2022-04-30 16:05:22,583 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:05:22,583 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:05:22,583 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:05:23,540 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:05:23,555 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:05:23,571 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:05:23,602 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:05:23,665 - multiprocessing - INFO - Connection closed
2022-04-30 16:05:23,681 - multiprocessing - INFO - process shutting down
2022-04-30 16:06:24,286 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:06:24,286 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:06:27,580 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A96696A860>
2022-04-30 16:06:27,580 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A96696A860> by query: select 1 from DUAL
2022-04-30 16:06:28,205 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A96696A860> successfully checked
2022-04-30 16:06:28,205 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:06:28,221 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:06:28,221 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:06:29,080 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:06:29,096 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:06:29,112 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:06:29,143 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:06:29,174 - multiprocessing - INFO - Connection closed
2022-04-30 16:06:29,186 - multiprocessing - INFO - process shutting down
2022-04-30 16:07:32,388 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:07:32,388 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:07:35,454 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BD4317A860>
2022-04-30 16:07:35,454 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BD4317A860> by query: select 1 from DUAL
2022-04-30 16:07:35,955 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BD4317A860> successfully checked
2022-04-30 16:07:35,955 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:07:35,955 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:07:35,955 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:07:37,201 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:07:37,217 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:07:37,248 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:07:37,280 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:07:37,295 - multiprocessing - INFO - Connection closed
2022-04-30 16:07:37,354 - multiprocessing - INFO - process shutting down
2022-04-30 16:08:07,415 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:08:07,431 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:08:10,702 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024C165FE860>
2022-04-30 16:08:10,702 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024C165FE860> by query: select 1 from DUAL
2022-04-30 16:08:11,187 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024C165FE860> successfully checked
2022-04-30 16:08:11,187 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:08:11,187 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:08:11,187 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:08:12,312 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:08:12,312 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:08:12,327 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:08:12,359 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:08:12,374 - multiprocessing - INFO - Connection closed
2022-04-30 16:08:12,413 - multiprocessing - INFO - process shutting down
2022-04-30 16:08:42,582 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:08:42,582 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:08:45,446 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002147254E860>
2022-04-30 16:08:45,446 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002147254E860> by query: select 1 from DUAL
2022-04-30 16:08:45,925 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002147254E860> successfully checked
2022-04-30 16:08:45,925 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:08:45,925 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:08:45,925 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:08:46,832 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:08:46,847 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:08:46,863 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:08:46,941 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:08:46,972 - multiprocessing - INFO - Connection closed
2022-04-30 16:08:47,015 - multiprocessing - INFO - process shutting down
2022-04-30 16:09:01,443 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:09:01,443 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:09:04,900 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000255F42BE860>
2022-04-30 16:09:04,900 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000255F42BE860> by query: select 1 from DUAL
2022-04-30 16:09:05,578 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000255F42BE860> successfully checked
2022-04-30 16:09:05,578 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:09:05,578 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:09:05,578 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:09:05,762 - multiprocessing - INFO - process shutting down
2022-04-30 16:09:17,809 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:09:17,809 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:09:21,030 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000028CB21CE860>
2022-04-30 16:09:21,030 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000028CB21CE860> by query: select 1 from DUAL
2022-04-30 16:09:21,561 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000028CB21CE860> successfully checked
2022-04-30 16:09:21,561 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:09:21,561 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:09:21,561 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:09:21,622 - multiprocessing - INFO - process shutting down
2022-04-30 16:09:36,775 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:09:36,775 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:09:39,679 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000027B8C02E860>
2022-04-30 16:09:39,679 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000027B8C02E860> by query: select 1 from DUAL
2022-04-30 16:09:40,164 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000027B8C02E860> successfully checked
2022-04-30 16:09:40,164 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:09:40,164 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:09:40,164 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:09:40,251 - multiprocessing - INFO - process shutting down
2022-04-30 16:09:54,257 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:09:54,257 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:09:57,896 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000208DE2EE860>
2022-04-30 16:09:57,912 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000208DE2EE860> by query: select 1 from DUAL
2022-04-30 16:09:58,365 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000208DE2EE860> successfully checked
2022-04-30 16:09:58,365 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:09:58,365 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:09:58,381 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:09:58,456 - multiprocessing - INFO - process shutting down
2022-04-30 16:10:08,550 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:10:08,550 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:10:11,804 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C62AADA860>
2022-04-30 16:10:11,804 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C62AADA860> by query: select 1 from DUAL
2022-04-30 16:10:12,773 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C62AADA860> successfully checked
2022-04-30 16:10:12,773 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:10:12,773 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:10:12,773 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:10:12,835 - multiprocessing - INFO - process shutting down
2022-04-30 16:10:28,561 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:10:28,561 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:10:31,543 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002133B05E860>
2022-04-30 16:10:31,543 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002133B05E860> by query: select 1 from DUAL
2022-04-30 16:10:32,230 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002133B05E860> successfully checked
2022-04-30 16:10:32,230 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:10:32,246 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:10:32,246 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:10:32,964 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:10:32,980 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:10:32,996 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:10:33,043 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:10:33,058 - multiprocessing - INFO - Connection closed
2022-04-30 16:10:33,079 - multiprocessing - INFO - process shutting down
2022-04-30 16:10:56,678 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:10:56,678 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:11:00,097 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000160AC43E860>
2022-04-30 16:11:00,097 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000160AC43E860> by query: select 1 from DUAL
2022-04-30 16:11:00,597 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000160AC43E860> successfully checked
2022-04-30 16:11:00,597 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:11:00,597 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:11:00,597 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:11:01,238 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:11:01,254 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:11:01,269 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:11:01,300 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:11:01,332 - multiprocessing - INFO - Connection closed
2022-04-30 16:11:01,349 - multiprocessing - INFO - process shutting down
2022-04-30 16:11:11,330 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:11:11,330 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:11:14,399 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000153C41BE860>
2022-04-30 16:11:14,399 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000153C41BE860> by query: select 1 from DUAL
2022-04-30 16:11:14,868 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000153C41BE860> successfully checked
2022-04-30 16:11:14,868 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:11:14,868 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:11:14,868 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:11:15,571 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:11:15,571 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:11:15,587 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:11:15,618 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:11:15,634 - multiprocessing - INFO - Connection closed
2022-04-30 16:11:15,646 - multiprocessing - INFO - process shutting down
2022-04-30 16:11:40,893 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:11:40,893 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:11:44,464 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000217F50EE860>
2022-04-30 16:11:44,464 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000217F50EE860> by query: select 1 from DUAL
2022-04-30 16:11:44,995 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000217F50EE860> successfully checked
2022-04-30 16:11:44,995 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:11:44,995 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:11:44,995 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:11:45,139 - multiprocessing - INFO - process shutting down
2022-04-30 16:12:13,754 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:12:13,754 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:12:17,011 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021215C7E860>
2022-04-30 16:12:17,011 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021215C7E860> by query: select 1 from DUAL
2022-04-30 16:12:17,495 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021215C7E860> successfully checked
2022-04-30 16:12:17,495 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:12:17,495 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:12:17,495 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:12:17,723 - multiprocessing - INFO - process shutting down
2022-04-30 16:12:36,788 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:12:36,788 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:12:39,822 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BB2912E860>
2022-04-30 16:12:39,822 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BB2912E860> by query: select 1 from DUAL
2022-04-30 16:12:40,384 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BB2912E860> successfully checked
2022-04-30 16:12:40,384 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:12:40,384 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:12:40,384 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:12:40,931 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:12:40,931 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:12:40,947 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:12:40,978 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:12:41,009 - multiprocessing - INFO - Connection closed
2022-04-30 16:12:41,020 - multiprocessing - INFO - process shutting down
2022-04-30 16:13:25,315 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:13:25,315 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:13:28,345 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000020071EBA890>
2022-04-30 16:13:28,345 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000020071EBA890> by query: select 1 from DUAL
2022-04-30 16:13:28,829 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000020071EBA890> successfully checked
2022-04-30 16:13:28,829 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:13:28,829 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:13:28,845 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:13:29,548 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:13:29,564 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:13:29,579 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:13:29,657 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:13:29,673 - multiprocessing - INFO - Connection closed
2022-04-30 16:13:29,724 - multiprocessing - INFO - process shutting down
2022-04-30 16:13:35,584 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:13:35,584 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:13:38,588 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000020D0339E860>
2022-04-30 16:13:38,588 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000020D0339E860> by query: select 1 from DUAL
2022-04-30 16:13:39,072 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000020D0339E860> successfully checked
2022-04-30 16:13:39,072 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:13:39,072 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:13:39,072 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:13:39,977 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:13:39,992 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:13:40,008 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:13:40,086 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:13:40,102 - multiprocessing - INFO - Connection closed
2022-04-30 16:13:40,139 - multiprocessing - INFO - process shutting down
2022-04-30 16:14:07,978 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:14:07,978 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:14:11,179 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001E740E6E860>
2022-04-30 16:14:11,179 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001E740E6E860> by query: select 1 from DUAL
2022-04-30 16:14:11,647 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001E740E6E860> successfully checked
2022-04-30 16:14:11,647 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:14:11,647 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:14:11,647 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:14:12,621 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:14:12,636 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:14:12,652 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:14:12,746 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:14:12,761 - multiprocessing - INFO - Connection closed
2022-04-30 16:14:12,811 - multiprocessing - INFO - process shutting down
2022-04-30 16:15:20,930 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:15:20,930 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:15:23,959 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001CBF813A860>
2022-04-30 16:15:23,959 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001CBF813A860> by query: select 1 from DUAL
2022-04-30 16:15:24,459 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001CBF813A860> successfully checked
2022-04-30 16:15:24,459 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:15:24,459 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:15:24,459 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:15:24,545 - multiprocessing - INFO - process shutting down
2022-04-30 16:15:37,917 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:15:37,918 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:15:41,487 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002189DB0E860>
2022-04-30 16:15:41,487 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002189DB0E860> by query: select 1 from DUAL
2022-04-30 16:15:42,068 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002189DB0E860> successfully checked
2022-04-30 16:15:42,068 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:15:42,068 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:15:42,068 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:15:42,144 - multiprocessing - INFO - process shutting down
2022-04-30 16:15:58,812 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:15:58,812 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:16:03,027 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002818252E860>
2022-04-30 16:16:03,028 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002818252E860> by query: select 1 from DUAL
2022-04-30 16:16:03,587 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002818252E860> successfully checked
2022-04-30 16:16:03,587 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:16:03,590 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:16:03,595 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:16:03,886 - multiprocessing - INFO - process shutting down
2022-04-30 16:17:03,866 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:17:03,866 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:17:06,997 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C2B029E860>
2022-04-30 16:17:07,013 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C2B029E860> by query: select 1 from DUAL
2022-04-30 16:17:07,528 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C2B029E860> successfully checked
2022-04-30 16:17:07,528 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:17:07,528 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:17:07,528 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:17:08,716 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:17:08,716 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:17:08,731 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:17:08,763 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:17:08,778 - multiprocessing - INFO - Connection closed
2022-04-30 16:17:08,804 - multiprocessing - INFO - process shutting down
2022-04-30 16:17:36,497 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:17:36,497 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:17:39,452 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000028FB8CEE860>
2022-04-30 16:17:39,452 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000028FB8CEE860> by query: select 1 from DUAL
2022-04-30 16:17:39,905 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000028FB8CEE860> successfully checked
2022-04-30 16:17:39,905 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:17:39,905 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:17:39,905 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:17:40,734 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:17:40,734 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:17:40,765 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:17:40,796 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:17:40,827 - multiprocessing - INFO - Connection closed
2022-04-30 16:17:40,843 - multiprocessing - INFO - process shutting down
2022-04-30 16:22:15,085 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:22:15,085 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:22:18,006 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000017ED6E7E860>
2022-04-30 16:22:18,006 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000017ED6E7E860> by query: select 1 from DUAL
2022-04-30 16:22:18,600 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000017ED6E7E860> successfully checked
2022-04-30 16:22:18,600 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:22:18,600 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:22:18,600 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:22:19,303 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:22:19,318 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:22:19,334 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:22:19,428 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:22:19,443 - multiprocessing - INFO - Connection closed
2022-04-30 16:22:19,490 - multiprocessing - INFO - process shutting down
2022-04-30 16:23:11,260 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:23:11,260 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:23:14,430 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000181AD95E860>
2022-04-30 16:23:14,430 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000181AD95E860> by query: select 1 from DUAL
2022-04-30 16:23:14,946 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000181AD95E860> successfully checked
2022-04-30 16:23:14,946 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:23:14,946 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:23:14,946 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:23:15,009 - multiprocessing - INFO - Actual date: <built-in method date of datetime.datetime object at 0x00000181AD95F5A0>
2022-04-30 16:23:15,009 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:23:15,821 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:23:15,837 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:23:15,852 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:23:15,884 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:23:15,915 - multiprocessing - INFO - Connection closed
2022-04-30 16:23:15,929 - multiprocessing - INFO - process shutting down
2022-04-30 16:23:41,445 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:23:41,445 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:23:44,588 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000029BFC4AE860>
2022-04-30 16:23:44,588 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000029BFC4AE860> by query: select 1 from DUAL
2022-04-30 16:23:45,057 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000029BFC4AE860> successfully checked
2022-04-30 16:23:45,057 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:23:45,057 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:23:45,073 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:23:45,120 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 16:23:45,120 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:23:45,910 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:23:45,926 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:23:45,942 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:23:46,020 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:23:46,051 - multiprocessing - INFO - Connection closed
2022-04-30 16:23:46,079 - multiprocessing - INFO - process shutting down
2022-04-30 16:24:25,158 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:24:25,158 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:24:28,464 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000263DCDEE860>
2022-04-30 16:24:28,480 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000263DCDEE860> by query: select 1 from DUAL
2022-04-30 16:24:28,839 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000263DCDEE860> successfully checked
2022-04-30 16:24:28,839 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:24:28,839 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:24:28,855 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:24:28,871 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 16:24:28,871 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:24:28,871 - multiprocessing - INFO - No actual data to insert! No df will be created, exit function "terminals_to_staging"
2022-04-30 16:24:28,902 - multiprocessing - INFO - Connection closed
2022-04-30 16:24:28,958 - multiprocessing - INFO - process shutting down
2022-04-30 16:30:57,892 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:30:57,893 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:31:00,997 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BF116DE860>
2022-04-30 16:31:00,997 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BF116DE860> by query: select 1 from DUAL
2022-04-30 16:31:01,519 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BF116DE860> successfully checked
2022-04-30 16:31:01,519 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:31:01,520 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 16:31:01,526 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 16:31:01,657 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 16:31:01,657 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:31:02,503 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:31:02,524 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:31:02,549 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:31:02,581 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:31:02,604 - multiprocessing - INFO - Connection closed
2022-04-30 16:31:02,613 - multiprocessing - INFO - process shutting down
2022-04-30 16:48:55,043 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:48:55,043 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:48:58,029 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000016AB1399C00>
2022-04-30 16:48:58,029 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000016AB1399C00> by query: select 1 from DUAL
2022-04-30 16:48:58,544 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000016AB1399C00> successfully checked
2022-04-30 16:48:58,544 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:48:58,544 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:48:58,544 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:48:58,591 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 16:48:58,591 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:48:59,591 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:48:59,607 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:48:59,622 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:48:59,700 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:48:59,733 - multiprocessing - INFO - process shutting down
2022-04-30 16:50:22,626 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:50:22,627 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:50:26,411 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002AC14229C00>
2022-04-30 16:50:26,411 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002AC14229C00> by query: select 1 from DUAL
2022-04-30 16:50:26,900 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002AC14229C00> successfully checked
2022-04-30 16:50:26,900 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:50:26,901 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:50:26,906 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:50:26,928 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 16:50:26,928 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:50:28,048 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:50:28,065 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:50:28,081 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:50:28,117 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:50:28,118 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\py_scripts\terminals_03032021.xlsx wasn't backed up with Exception [Errno 2] No such file or directory: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\py_scripts\\terminals_03032021.xlsx'
2022-04-30 16:50:28,137 - multiprocessing - INFO - Connection closed
2022-04-30 16:50:28,189 - multiprocessing - INFO - process shutting down
2022-04-30 16:52:23,850 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:52:23,850 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:52:27,501 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000029CF7539C00>
2022-04-30 16:52:27,502 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000029CF7539C00> by query: select 1 from DUAL
2022-04-30 16:52:27,998 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000029CF7539C00> successfully checked
2022-04-30 16:52:27,999 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:52:28,000 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 16:52:28,004 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 16:52:28,024 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 16:52:28,024 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:52:29,003 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:52:29,017 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:52:29,035 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:52:29,070 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:52:29,073 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfullybacked up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 16:52:29,092 - multiprocessing - INFO - Connection closed
2022-04-30 16:52:29,107 - multiprocessing - INFO - process shutting down
2022-04-30 16:53:07,388 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:53:07,388 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:53:10,164 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001DD21829C00>
2022-04-30 16:53:10,164 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001DD21829C00> by query: select 1 from DUAL
2022-04-30 16:53:10,539 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001DD21829C00> successfully checked
2022-04-30 16:53:10,539 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:53:10,539 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 16:53:10,554 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 16:53:10,570 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 16:53:10,570 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:53:11,648 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:53:11,664 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:53:11,679 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:53:11,711 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:53:11,711 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 16:53:11,742 - multiprocessing - INFO - Connection closed
2022-04-30 16:53:11,762 - multiprocessing - INFO - process shutting down
2022-04-30 16:54:15,540 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 16:54:15,540 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 16:54:18,407 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001F4743B9BD0>
2022-04-30 16:54:18,407 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001F4743B9BD0> by query: select 1 from DUAL
2022-04-30 16:54:18,923 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001F4743B9BD0> successfully checked
2022-04-30 16:54:18,923 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 16:54:18,923 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 16:54:18,923 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 16:54:18,969 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 16:54:18,969 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 16:54:19,672 - multiprocessing - INFO - Created dataframe:
2022-04-30 16:54:19,719 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 16:54:19,735 - multiprocessing - INFO - Staging was cleared!
2022-04-30 16:54:19,829 - multiprocessing - INFO - Data was inserted!
2022-04-30 16:54:19,829 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 16:54:19,844 - multiprocessing - INFO - Connection closed
2022-04-30 16:54:19,874 - multiprocessing - INFO - process shutting down
2022-04-30 18:48:50,877 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 18:48:50,877 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 18:48:53,927 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000015B37559C00>
2022-04-30 18:48:53,927 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000015B37559C00> by query: select 1 from DUAL
2022-04-30 18:48:54,411 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000015B37559C00> successfully checked
2022-04-30 18:48:54,411 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 18:48:54,411 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 18:48:54,411 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 18:48:54,458 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 18:48:54,458 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 18:48:55,442 - multiprocessing - INFO - Created dataframe:
2022-04-30 18:48:55,458 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 18:48:55,474 - multiprocessing - INFO - Staging was cleared!
2022-04-30 18:48:55,505 - multiprocessing - INFO - Data was inserted!
2022-04-30 18:48:55,558 - multiprocessing - INFO - process shutting down
2022-04-30 18:51:49,017 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 18:51:49,017 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 18:51:52,112 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024B38869C00>
2022-04-30 18:51:52,112 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024B38869C00> by query: select 1 from DUAL
2022-04-30 18:51:52,643 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024B38869C00> successfully checked
2022-04-30 18:51:52,643 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 18:51:52,643 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 18:51:52,643 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 18:51:52,659 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 18:51:52,675 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 18:51:53,581 - multiprocessing - INFO - Created dataframe:
2022-04-30 18:51:53,596 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 18:51:53,612 - multiprocessing - INFO - Staging was cleared!
2022-04-30 18:51:53,643 - multiprocessing - INFO - Data was inserted!
2022-04-30 18:51:53,690 - multiprocessing - INFO - Making SQL-query:
 -- Инкрементальная загрузка данных по терминалам

-- 1. Очистка стейджинга с удаленными значениеями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 18:51:53,753 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 18:51:53,753 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 18:51:53,768 - multiprocessing - INFO - Connection closed
2022-04-30 18:51:53,796 - multiprocessing - INFO - process shutting down
2022-04-30 18:55:00,282 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 18:55:00,282 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 18:55:03,032 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000157EAEB9C00>
2022-04-30 18:55:03,032 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000157EAEB9C00> by query: select 1 from DUAL
2022-04-30 18:55:03,532 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000157EAEB9C00> successfully checked
2022-04-30 18:55:03,532 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 18:55:03,532 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 18:55:03,532 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 18:55:03,578 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 18:55:03,578 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 18:55:04,585 - multiprocessing - INFO - Created dataframe:
2022-04-30 18:55:04,600 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 18:55:04,616 - multiprocessing - INFO - Staging was cleared!
2022-04-30 18:55:04,663 - multiprocessing - INFO - Data was inserted!
2022-04-30 18:55:04,663 - multiprocessing - INFO - Making SQL-query:
 -- Инкрементальная загрузка данных по терминалам

-- 1. Очистка стейджинга с удаленными значениеями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 18:55:04,694 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 18:55:04,710 - multiprocessing - INFO - Connection closed
2022-04-30 18:55:04,730 - multiprocessing - INFO - process shutting down
2022-04-30 19:14:59,671 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:14:59,671 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:15:03,050 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001B0F46D9C00>
2022-04-30 19:15:03,050 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001B0F46D9C00> by query: select 1 from DUAL
2022-04-30 19:15:03,534 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001B0F46D9C00> successfully checked
2022-04-30 19:15:03,534 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:15:03,534 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 19:15:03,534 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 19:15:03,581 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 19:15:03,581 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 19:15:04,487 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:15:04,487 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:15:04,519 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:15:04,550 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:15:04,566 - multiprocessing - INFO - Making SQL-query:
 -- Инкрементальная загрузка данных по терминалам

-- 1. Очистка стейджинга с удаленными значениеями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:15:04,597 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:15:04,612 - multiprocessing - INFO - Connection closed
2022-04-30 19:15:04,633 - multiprocessing - INFO - process shutting down
2022-04-30 19:16:15,618 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:16:15,618 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:16:18,913 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001B12BFC9C00>
2022-04-30 19:16:18,913 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001B12BFC9C00> by query: select 1 from DUAL
2022-04-30 19:16:19,475 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001B12BFC9C00> successfully checked
2022-04-30 19:16:19,475 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:16:19,475 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 19:16:19,475 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 19:16:19,522 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 19:16:19,522 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 19:16:19,522 - multiprocessing - INFO - No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 19:16:19,538 - multiprocessing - INFO - Connection closed
2022-04-30 19:16:19,581 - multiprocessing - INFO - process shutting down
2022-04-30 19:18:24,240 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:18:24,240 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:18:26,956 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001E61E499C00>
2022-04-30 19:18:26,956 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001E61E499C00> by query: select 1 from DUAL
2022-04-30 19:18:27,441 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001E61E499C00> successfully checked
2022-04-30 19:18:27,441 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:18:27,441 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:18:27,441 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:18:27,487 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:18:27,487 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 19:18:28,487 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:18:28,487 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:18:28,503 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:18:28,534 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:18:28,566 - multiprocessing - INFO - Making SQL-query:
 -- Инкрементальная загрузка данных по терминалам

-- 1. Очистка стейджинга с удаленными значениеями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:18:28,597 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:18:28,612 - multiprocessing - INFO - Connection closed
2022-04-30 19:18:28,628 - multiprocessing - INFO - process shutting down
2022-04-30 19:20:18,493 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:20:18,493 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:20:21,311 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001FF0A3A9BD0>
2022-04-30 19:20:21,311 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001FF0A3A9BD0> by query: select 1 from DUAL
2022-04-30 19:20:21,748 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001FF0A3A9BD0> successfully checked
2022-04-30 19:20:21,748 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:20:21,748 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:20:21,748 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:20:21,779 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:20:21,779 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 19:20:22,342 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:20:22,342 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:20:22,358 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:20:22,389 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:20:22,404 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
--delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:20:22,436 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:20:22,451 - multiprocessing - INFO - Connection closed
2022-04-30 19:20:22,682 - multiprocessing - INFO - process shutting down
2022-04-30 19:23:00,204 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:23:00,204 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:23:03,009 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000183A536DBD0>
2022-04-30 19:23:03,009 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000183A536DBD0> by query: select 1 from DUAL
2022-04-30 19:23:03,525 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000183A536DBD0> successfully checked
2022-04-30 19:23:03,525 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:23:03,540 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:23:03,540 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:23:03,556 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:23:03,556 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 19:23:04,197 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:23:04,212 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:23:04,228 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:23:04,259 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:23:04,275 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;
--delete from demipt2.gold_dwh_dim_terminals_hist;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:23:04,306 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:23:04,415 - multiprocessing - INFO - Connection closed
2022-04-30 19:23:04,436 - multiprocessing - INFO - process shutting down
2022-04-30 19:24:36,624 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:24:36,624 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:24:39,674 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000217E2559BD0>
2022-04-30 19:24:39,674 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000217E2559BD0> by query: select 1 from DUAL
2022-04-30 19:24:40,119 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000217E2559BD0> successfully checked
2022-04-30 19:24:40,119 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:24:40,119 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:24:40,119 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:24:40,150 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:24:40,150 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 19:24:40,150 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 19:24:40,166 - multiprocessing - INFO - Connection closed
2022-04-30 19:24:40,205 - multiprocessing - INFO - process shutting down
2022-04-30 19:27:55,106 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:27:55,108 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:27:59,763 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024130F89BD0>
2022-04-30 19:27:59,763 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024130F89BD0> by query: select 1 from DUAL
2022-04-30 19:28:00,270 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024130F89BD0> successfully checked
2022-04-30 19:28:00,270 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:28:00,271 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:28:00,276 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:28:00,295 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:28:00,295 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:28:01,464 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:28:01,497 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:28:01,509 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:28:01,546 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:28:01,568 - multiprocessing - INFO - Making SQL-query:
 delete from demipt2.gold_stg_dim_terminals_del;

insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;


commit;
2022-04-30 19:28:01,603 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:28:01,615 - multiprocessing - INFO - Connection closed
2022-04-30 19:28:01,645 - multiprocessing - INFO - process shutting down
2022-04-30 19:33:18,123 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:33:18,124 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:33:21,769 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000012827749BD0>
2022-04-30 19:33:21,769 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000012827749BD0> by query: select 1 from DUAL
2022-04-30 19:33:23,568 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000012827749BD0> successfully checked
2022-04-30 19:33:23,569 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:33:23,572 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:33:23,582 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:33:23,609 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:33:23,609 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:33:24,727 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:33:24,739 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:33:24,767 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:33:24,799 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:33:24,817 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second


-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')


-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')


-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')


-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:33:24,849 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00933: неверное завершение SQL-предложения

2022-04-30 19:33:24,861 - multiprocessing - INFO - Connection closed
2022-04-30 19:33:25,074 - multiprocessing - INFO - process shutting down
2022-04-30 19:34:13,118 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:34:13,119 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:34:16,262 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021D30FDDBD0>
2022-04-30 19:34:16,263 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021D30FDDBD0> by query: select 1 from DUAL
2022-04-30 19:34:16,860 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021D30FDDBD0> successfully checked
2022-04-30 19:34:16,861 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:34:16,862 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:34:16,869 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:34:16,910 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:34:16,910 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:34:17,996 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:34:18,008 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:34:18,025 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:34:18,059 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:34:18,085 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:34:18,122 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:34:18,244 - multiprocessing - INFO - Connection closed
2022-04-30 19:34:18,256 - multiprocessing - INFO - process shutting down
2022-04-30 19:36:25,236 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:36:25,236 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:36:28,418 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000215C7339C00>
2022-04-30 19:36:28,419 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000215C7339C00> by query: select 1 from DUAL
2022-04-30 19:36:28,916 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000215C7339C00> successfully checked
2022-04-30 19:36:28,916 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:36:28,917 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:36:28,923 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:36:28,967 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:36:28,967 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:36:29,903 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:36:29,920 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:36:29,939 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:36:30,042 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:36:30,149 - multiprocessing - INFO - process shutting down
2022-04-30 19:37:09,543 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:37:09,544 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:37:12,635 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002B8B6C7DBD0>
2022-04-30 19:37:12,636 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002B8B6C7DBD0> by query: select 1 from DUAL
2022-04-30 19:37:13,028 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002B8B6C7DBD0> successfully checked
2022-04-30 19:37:13,028 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:37:13,029 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:37:13,034 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:37:13,053 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:37:13,053 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:37:13,996 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:37:14,007 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:37:14,024 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:37:14,059 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:37:14,080 - multiprocessing - INFO - Making SQL-query:
 delete from demipt2.gold_stg_dim_terminals_del;


insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;


merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;


commit;
2022-04-30 19:37:14,116 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:37:14,129 - multiprocessing - INFO - Connection closed
2022-04-30 19:37:14,147 - multiprocessing - INFO - process shutting down
2022-04-30 19:37:27,996 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:37:27,997 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:37:30,881 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BDA9899BD0>
2022-04-30 19:37:30,881 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BDA9899BD0> by query: select 1 from DUAL
2022-04-30 19:37:31,299 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BDA9899BD0> successfully checked
2022-04-30 19:37:31,299 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:37:31,300 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:37:31,305 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:37:31,326 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:37:31,327 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:37:32,130 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:37:32,145 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:37:32,168 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:37:32,263 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:37:32,283 - multiprocessing - INFO - Making SQL-query:
 


insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;


merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;


commit;
2022-04-30 19:37:32,310 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:37:32,321 - multiprocessing - INFO - Connection closed
2022-04-30 19:37:32,365 - multiprocessing - INFO - process shutting down
2022-04-30 19:37:41,171 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:37:41,172 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:37:44,112 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C39DA1DBD0>
2022-04-30 19:37:44,113 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C39DA1DBD0> by query: select 1 from DUAL
2022-04-30 19:37:44,570 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C39DA1DBD0> successfully checked
2022-04-30 19:37:44,571 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:37:44,572 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:37:44,578 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:37:44,615 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:37:44,615 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:37:45,545 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:37:45,561 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:37:45,572 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:37:45,665 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:37:45,676 - multiprocessing - INFO - Making SQL-query:
 insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;


merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;


insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;


update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;


commit;
2022-04-30 19:37:45,714 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:37:45,725 - multiprocessing - INFO - Connection closed
2022-04-30 19:37:45,756 - multiprocessing - INFO - process shutting down
2022-04-30 19:38:41,600 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:38:41,601 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:38:44,693 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000016A4A609C00>
2022-04-30 19:38:44,694 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000016A4A609C00> by query: select 1 from DUAL
2022-04-30 19:38:45,172 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000016A4A609C00> successfully checked
2022-04-30 19:38:45,173 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:38:45,174 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:38:45,178 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:38:45,201 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:38:45,202 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:38:46,297 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:38:46,310 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:38:46,321 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:38:46,352 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:38:46,425 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:38:46,465 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:38:46,477 - multiprocessing - INFO - Connection closed
2022-04-30 19:38:46,490 - multiprocessing - INFO - process shutting down
2022-04-30 19:39:36,362 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:39:36,363 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:39:39,464 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000263A4169C00>
2022-04-30 19:39:39,464 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000263A4169C00> by query: select 1 from DUAL
2022-04-30 19:39:39,867 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000263A4169C00> successfully checked
2022-04-30 19:39:39,867 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:39:39,868 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:39:39,873 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:39:39,897 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:39:39,898 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:39:40,884 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:39:40,897 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:39:40,923 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:39:40,957 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:39:40,972 - multiprocessing - INFO - Making SQL-query:
 --Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:39:41,006 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:39:41,021 - multiprocessing - INFO - Connection closed
2022-04-30 19:39:41,035 - multiprocessing - INFO - process shutting down
2022-04-30 19:42:28,930 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:42:28,931 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:42:32,080 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000028BB10B9C00>
2022-04-30 19:42:32,080 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000028BB10B9C00> by query: select 1 from DUAL
2022-04-30 19:42:32,678 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000028BB10B9C00> successfully checked
2022-04-30 19:42:32,678 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:42:32,679 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:42:32,684 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:42:32,705 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:42:32,705 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:42:33,583 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:42:33,595 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:42:33,611 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:42:33,650 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:42:33,661 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:42:33,692 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:42:33,723 - multiprocessing - INFO - Connection closed
2022-04-30 19:42:33,735 - multiprocessing - INFO - process shutting down
2022-04-30 19:42:55,873 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:42:55,874 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:42:58,825 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000020D7C759C00>
2022-04-30 19:42:58,825 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000020D7C759C00> by query: select 1 from DUAL
2022-04-30 19:42:59,267 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000020D7C759C00> successfully checked
2022-04-30 19:42:59,267 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:42:59,268 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:42:59,274 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:42:59,294 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:42:59,294 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:43:00,160 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:43:00,175 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:43:00,201 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:43:00,275 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:43:00,311 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:43:00,315 - multiprocessing - INFO - Failed to perform query with Exception Cursor.executemany() missing 1 required positional argument: 'seq_of_parameters'
2022-04-30 19:43:00,328 - multiprocessing - INFO - Connection closed
2022-04-30 19:43:00,339 - multiprocessing - INFO - process shutting down
2022-04-30 19:44:00,478 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:44:00,478 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:44:03,559 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000020B060B9C00>
2022-04-30 19:44:03,560 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000020B060B9C00> by query: select 1 from DUAL
2022-04-30 19:44:04,223 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000020B060B9C00> successfully checked
2022-04-30 19:44:04,223 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:44:04,224 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:44:04,230 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:44:04,256 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:44:04,257 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:44:04,776 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:44:04,788 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:44:04,811 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:44:04,844 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:44:04,857 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:44:04,865 - multiprocessing - INFO - Failed to perform query with Exception 'Cursor' object has no attribute 'executeall'
2022-04-30 19:44:04,889 - multiprocessing - INFO - Connection closed
2022-04-30 19:44:04,898 - multiprocessing - INFO - process shutting down
2022-04-30 19:45:22,906 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:45:22,907 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:45:25,851 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BF47D39C00>
2022-04-30 19:45:25,852 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BF47D39C00> by query: select 1 from DUAL
2022-04-30 19:45:26,391 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BF47D39C00> successfully checked
2022-04-30 19:45:26,392 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:45:26,393 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:45:26,399 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:45:26,440 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:45:26,441 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:45:27,328 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:45:27,342 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:45:27,357 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:45:27,447 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:45:27,461 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
--commit;
2022-04-30 19:45:27,506 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:45:27,517 - multiprocessing - INFO - Connection closed
2022-04-30 19:45:27,700 - multiprocessing - INFO - process shutting down
2022-04-30 19:45:55,772 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:45:55,773 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:45:58,763 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002C0F4439C00>
2022-04-30 19:45:58,763 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002C0F4439C00> by query: select 1 from DUAL
2022-04-30 19:45:59,255 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002C0F4439C00> successfully checked
2022-04-30 19:45:59,266 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:45:59,267 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:45:59,272 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:45:59,299 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:45:59,299 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:45:59,983 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:45:59,995 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:46:00,014 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:46:00,048 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:46:00,067 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:46:00,096 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:46:00,218 - multiprocessing - INFO - Connection closed
2022-04-30 19:46:00,230 - multiprocessing - INFO - process shutting down
2022-04-30 19:46:33,115 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:46:33,115 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:46:36,597 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000284FA3A9C00>
2022-04-30 19:46:36,598 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000284FA3A9C00> by query: select 1 from DUAL
2022-04-30 19:46:37,073 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000284FA3A9C00> successfully checked
2022-04-30 19:46:37,074 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:46:37,075 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:46:37,079 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:46:37,103 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:46:37,103 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:46:38,074 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:46:38,089 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:46:38,106 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:46:38,138 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:46:38,178 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам

--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;

-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;

-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник

-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;

-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)

-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;

-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;

-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:46:38,221 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:46:38,235 - multiprocessing - INFO - Connection closed
2022-04-30 19:46:38,246 - multiprocessing - INFO - process shutting down
2022-04-30 19:47:31,951 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:47:31,951 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:47:35,181 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000028F7C27DBD0>
2022-04-30 19:47:35,181 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000028F7C27DBD0> by query: select 1 from DUAL
2022-04-30 19:47:35,565 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000028F7C27DBD0> successfully checked
2022-04-30 19:47:35,566 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:47:35,567 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:47:35,571 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:47:35,590 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:47:35,590 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:47:36,511 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:47:36,529 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:47:36,541 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:47:36,603 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:47:36,627 - multiprocessing - INFO - Making SQL-query:
--Инкрементальная загрузка данных по терминалам
--1. Очистка стейджинга с удаленными значениями
delete from demipt2.gold_stg_dim_terminals_del;
-- 2. Захват ключей для вычисления удалений.
insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
select terminal_id from demipt2.gold_stg_dim_terminals;
-- 3. Выделяем "вставки" и "обновления" и вливаем их в приемник
-- 3.1. вставка новой строки или закрытие текущей версии по scd2
merge into demipt2.gold_dwh_dim_terminals_hist tgt
using (
    select
        s.terminal_id,
        s.terminal_type,
        s.terminal_city,
        s.terminal_address,
        s.update_dt,
        'n' as  deleted_flg,
        s.update_dt as effective_from,
        to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
    from demipt2.gold_stg_dim_terminals s
    left join demipt2.gold_dwh_dim_terminals_hist t
    on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
) stg
on ( tgt.terminal_id = stg.terminal_id )
when not matched then insert (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
    effective_to
    )
values (
    stg.terminal_id,
    stg.terminal_type,
    stg.terminal_city,
    stg.terminal_address,
    'n',
    stg.effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd')
    )
when matched then
update set effective_to = current_date - interval '1' second
;
-- 3.2. вставка новой версии по scd2 для случая апдейта
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
    deleted_flg,
    effective_from,
	effective_to
)
select
    s.terminal_id,
    s.terminal_type,
    s.terminal_city,
    s.terminal_address,
    'n' as  deleted_flg,
    current_date as effective_from,
    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_stg_dim_terminals s
left join demipt2.gold_dwh_dim_terminals_hist t
on s.terminal_id = t.terminal_id
    where
      1=1
      and t.terminal_id is  null
      or (
      t.terminal_id is not null
      and ( 1 = 0
            or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
            or (s.terminal_type is not null and t.terminal_type is null)
          )
      and ( 1 = 0
            or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
            or (s.terminal_city is not null and t.terminal_city is null)
          )
      and ( 1 = 0
            or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
            or (s.terminal_address is not null and t.terminal_address is null)
          )
      )
    and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
;
-- 4. проставляем в приемнике флаг для удаленных записей ('y' - для удаленных)
-- 4.1. вставляем актуальную запись по scd2
insert into demipt2.gold_dwh_dim_terminals_hist (
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	deleted_flg,
	effective_from,
	effective_to
	)
select
    terminal_id,
    terminal_type,
    terminal_city,
    terminal_address,
	'y' as deleted_flg,
	current_date as effective_from,
	to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
from demipt2.gold_dwh_dim_terminals_hist
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;
-- 4.2. обновляем данные об удаленной записи по scd2
update demipt2.gold_dwh_dim_terminals_hist
set effective_to = current_date - interval '1' second
where terminal_id in (
    select
        t.terminal_id
    from demipt2.gold_dwh_dim_terminals_hist t
    left join demipt2.gold_stg_dim_terminals_del s
    on t.terminal_id = s.terminal_id
    where s.terminal_id is null
	)
	and deleted_flg = 'n'
	and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
;
-- 5. Обновляем метаданные.
update demipt2.gold_meta_bank
set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null;
-- 6. Фиксируем транзакцию.
commit;
2022-04-30 19:47:36,669 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:47:36,679 - multiprocessing - INFO - Connection closed
2022-04-30 19:47:36,892 - multiprocessing - INFO - process shutting down
2022-04-30 19:49:22,813 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:49:22,813 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:49:26,065 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000196D0E89C00>
2022-04-30 19:49:26,066 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000196D0E89C00> by query: select 1 from DUAL
2022-04-30 19:49:26,441 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000196D0E89C00> successfully checked
2022-04-30 19:49:26,441 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:49:26,442 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:49:26,447 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:49:26,470 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:49:26,471 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:49:27,362 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:49:27,374 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:49:27,399 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:49:27,431 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:49:27,444 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts;
select * from demipt2.gold_stg_dim_accounts_del;
select * from demipt2.gold_dwh_dim_accounts_hist;
2022-04-30 19:49:27,467 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:49:27,480 - multiprocessing - INFO - Connection closed
2022-04-30 19:49:27,490 - multiprocessing - INFO - process shutting down
2022-04-30 19:49:52,239 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:49:52,240 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:49:55,121 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022653159BD0>
2022-04-30 19:49:55,122 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022653159BD0> by query: select 1 from DUAL
2022-04-30 19:49:55,537 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022653159BD0> successfully checked
2022-04-30 19:49:55,537 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:49:55,538 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:49:55,542 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:49:55,566 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:49:55,566 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:49:56,398 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:49:56,409 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:49:56,423 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:49:56,456 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:49:56,468 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts;select * from demipt2.gold_stg_dim_accounts_del;select * from demipt2.gold_dwh_dim_accounts_hist;
2022-04-30 19:49:56,494 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:49:56,507 - multiprocessing - INFO - Connection closed
2022-04-30 19:49:56,519 - multiprocessing - INFO - process shutting down
2022-04-30 19:50:09,088 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:50:09,089 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:50:12,177 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001CE16C6DBD0>
2022-04-30 19:50:12,177 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001CE16C6DBD0> by query: select 1 from DUAL
2022-04-30 19:50:12,751 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001CE16C6DBD0> successfully checked
2022-04-30 19:50:12,751 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:50:12,752 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:50:12,757 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:50:12,778 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:50:12,779 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:50:13,973 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:50:13,985 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:50:13,997 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:50:14,036 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:50:14,047 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts;
2022-04-30 19:50:14,073 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:50:14,085 - multiprocessing - INFO - Connection closed
2022-04-30 19:50:14,098 - multiprocessing - INFO - process shutting down
2022-04-30 19:51:28,106 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:51:28,107 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:51:31,181 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000015AC25A9C00>
2022-04-30 19:51:31,181 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000015AC25A9C00> by query: select 1 from DUAL
2022-04-30 19:51:31,615 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000015AC25A9C00> successfully checked
2022-04-30 19:51:31,615 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:51:31,616 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:51:31,621 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:51:31,639 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:51:31,639 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:51:32,748 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:51:32,759 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:51:32,770 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:51:32,801 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:51:32,811 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts;
2022-04-30 19:51:32,831 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 19:51:32,842 - multiprocessing - INFO - Connection closed
2022-04-30 19:51:32,873 - multiprocessing - INFO - process shutting down
2022-04-30 19:51:54,834 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:51:54,835 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:51:57,739 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000027731B39C00>
2022-04-30 19:51:57,740 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000027731B39C00> by query: select 1 from DUAL
2022-04-30 19:51:58,218 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000027731B39C00> successfully checked
2022-04-30 19:51:58,218 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:51:58,219 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:51:58,225 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:51:58,263 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:51:58,263 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:51:59,292 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:51:59,304 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:51:59,323 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:51:59,357 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:51:59,374 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts;
2022-04-30 19:51:59,391 - multiprocessing - INFO - Query performed
2022-04-30 19:51:59,410 - multiprocessing - INFO - Connection closed
2022-04-30 19:51:59,420 - multiprocessing - INFO - process shutting down
2022-04-30 19:53:18,889 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:53:18,889 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:53:22,001 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000016F25AA9C00>
2022-04-30 19:53:22,001 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000016F25AA9C00> by query: select 1 from DUAL
2022-04-30 19:53:22,523 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000016F25AA9C00> successfully checked
2022-04-30 19:53:22,523 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:53:22,524 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:53:22,529 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:53:22,547 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:53:22,548 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:53:23,503 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:53:23,515 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:53:23,525 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:53:23,556 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:53:23,567 - multiprocessing - INFO - Making SQL-query:
select * from demipt2.gold_stg_dim_accounts
select * from demipt2.gold_stg_dim_accounts_del
select * from demipt2.gold_dwh_dim_accounts_hist
2022-04-30 19:53:23,587 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00933: неверное завершение SQL-предложения

2022-04-30 19:53:23,602 - multiprocessing - INFO - Connection closed
2022-04-30 19:53:23,611 - multiprocessing - INFO - process shutting down
2022-04-30 19:58:22,221 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 19:58:22,221 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 19:58:25,161 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002A47C749C30>
2022-04-30 19:58:25,161 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002A47C749C30> by query: select 1 from DUAL
2022-04-30 19:58:25,537 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002A47C749C30> successfully checked
2022-04-30 19:58:25,537 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 19:58:25,538 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 19:58:25,543 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 19:58:25,561 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 19:58:25,561 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 19:58:26,426 - multiprocessing - INFO - Created dataframe:
2022-04-30 19:58:26,437 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 19:58:26,450 - multiprocessing - INFO - Staging was cleared!
2022-04-30 19:58:26,480 - multiprocessing - INFO - Data was inserted!
2022-04-30 19:58:26,489 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del
2022-04-30 19:58:26,497 - multiprocessing - INFO - Query performed
2022-04-30 19:58:26,500 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 19:58:26,512 - multiprocessing - INFO - Connection closed
2022-04-30 19:58:26,523 - multiprocessing - INFO - process shutting down
2022-04-30 20:12:13,302 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:12:13,303 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:12:16,813 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001998D249C30>
2022-04-30 20:12:16,813 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001998D249C30> by query: select 1 from DUAL
2022-04-30 20:12:17,615 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001998D249C30> successfully checked
2022-04-30 20:12:17,615 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:12:17,616 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 20:12:17,623 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 20:12:17,646 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 20:12:17,646 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:12:18,924 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:12:18,941 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:12:18,967 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:12:19,001 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:12:19,010 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del
2022-04-30 20:12:19,017 - multiprocessing - INFO - Query performed
2022-04-30 20:12:19,019 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 20:12:19,030 - multiprocessing - INFO - Connection closed
2022-04-30 20:12:19,048 - multiprocessing - INFO - process shutting down
2022-04-30 20:12:31,462 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:12:31,462 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:12:34,354 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000152CE8E9C30>
2022-04-30 20:12:34,354 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000152CE8E9C30> by query: select 1 from DUAL
2022-04-30 20:12:34,742 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000152CE8E9C30> successfully checked
2022-04-30 20:12:34,742 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:12:34,743 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:12:34,748 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:12:34,769 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:12:34,770 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:12:35,717 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:12:35,729 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:12:35,744 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:12:35,773 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:12:35,782 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:12:35,806 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:12:35,840 - multiprocessing - INFO - process shutting down
2022-04-30 20:13:07,837 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:13:07,837 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:13:10,844 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000231DA649C30>
2022-04-30 20:13:10,844 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000231DA649C30> by query: select 1 from DUAL
2022-04-30 20:13:11,370 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000231DA649C30> successfully checked
2022-04-30 20:13:11,371 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:13:11,372 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:13:11,377 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:13:11,420 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:13:11,420 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:13:12,349 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:13:12,361 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:13:12,384 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:13:12,417 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:13:12,427 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:13:12,453 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:13:12,454 - multiprocessing - INFO - Making SQL-query:
rollback
2022-04-30 20:13:12,475 - multiprocessing - INFO - Connection closed
2022-04-30 20:13:12,487 - multiprocessing - INFO - process shutting down
2022-04-30 20:14:45,840 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:14:45,840 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:14:48,741 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001F52F1A9C30>
2022-04-30 20:14:48,742 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001F52F1A9C30> by query: select 1 from DUAL
2022-04-30 20:14:49,176 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001F52F1A9C30> successfully checked
2022-04-30 20:14:49,176 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:14:49,177 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:14:49,181 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:14:49,202 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:14:49,203 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:14:50,269 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:14:50,280 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:14:50,293 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:14:50,324 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:14:50,340 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:14:50,359 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:14:50,359 - multiprocessing - INFO - Making SQL-query:
rollback
2022-04-30 20:14:50,365 - multiprocessing - INFO - Rollback not performed!
2022-04-30 20:14:50,374 - multiprocessing - INFO - Connection closed
2022-04-30 20:14:50,386 - multiprocessing - INFO - process shutting down
2022-04-30 20:16:04,088 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:16:04,088 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:16:07,007 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000029C7A405C00>
2022-04-30 20:16:07,008 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000029C7A405C00> by query: select 1 from DUAL
2022-04-30 20:16:07,574 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000029C7A405C00> successfully checked
2022-04-30 20:16:07,574 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:16:07,575 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:16:07,579 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:16:07,599 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:16:07,599 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:16:08,391 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:16:08,403 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:16:08,423 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:16:08,455 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:16:08,466 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:16:08,492 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:16:08,493 - multiprocessing - INFO - Making SQL-query:
rollback
2022-04-30 20:16:08,501 - multiprocessing - INFO - Rollback not performed!
2022-04-30 20:16:08,526 - multiprocessing - INFO - Connection closed
2022-04-30 20:16:08,536 - multiprocessing - INFO - process shutting down
2022-04-30 20:20:56,208 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:20:56,208 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:20:59,852 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024F13849C00>
2022-04-30 20:20:59,852 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024F13849C00> by query: select 1 from DUAL
2022-04-30 20:21:00,620 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024F13849C00> successfully checked
2022-04-30 20:21:00,620 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:21:00,621 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:21:00,627 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:21:00,669 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:21:00,669 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:21:01,638 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:21:01,657 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:21:01,667 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:21:01,712 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:21:01,750 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:21:01,784 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:21:01,793 - multiprocessing - INFO - Rollback performed!
2022-04-30 20:21:01,794 - multiprocessing - INFO - Query performed
2022-04-30 20:21:01,796 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 20:21:01,808 - multiprocessing - INFO - Connection closed
2022-04-30 20:21:01,886 - multiprocessing - INFO - process shutting down
2022-04-30 20:30:04,197 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:30:04,198 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:30:07,715 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000184CAF45E10>
2022-04-30 20:30:07,715 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000184CAF45E10> by query: select 1 from DUAL
2022-04-30 20:30:08,207 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000184CAF45E10> successfully checked
2022-04-30 20:30:08,207 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:30:08,208 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:30:08,209 - multiprocessing - INFO - List of files for processing: []
2022-04-30 20:30:08,209 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: local variable 'filename_latest' referenced before assignment
2022-04-30 20:30:08,209 - multiprocessing - INFO - ETL-process stopped
2022-04-30 20:30:08,284 - multiprocessing - INFO - process shutting down
2022-04-30 20:31:55,132 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:31:55,132 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:31:58,421 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000019BB2809E10>
2022-04-30 20:31:58,421 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000019BB2809E10> by query: select 1 from DUAL
2022-04-30 20:31:58,815 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000019BB2809E10> successfully checked
2022-04-30 20:31:58,815 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:31:58,816 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:31:58,828 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:31:58,855 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:31:58,855 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:31:59,959 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:31:59,970 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:31:59,994 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:32:00,024 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:32:00,045 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:32:00,065 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:32:00,071 - multiprocessing - INFO - Rollback performed!
2022-04-30 20:32:00,074 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 20:32:00,084 - multiprocessing - INFO - Connection closed
2022-04-30 20:32:00,095 - multiprocessing - INFO - process shutting down
2022-04-30 20:35:57,764 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:35:57,764 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:36:00,493 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001914B8A9E10>
2022-04-30 20:36:00,493 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001914B8A9E10> by query: select 1 from DUAL
2022-04-30 20:36:01,010 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001914B8A9E10> successfully checked
2022-04-30 20:36:01,011 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:36:01,012 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 20:36:01,019 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 20:36:01,129 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 20:36:01,130 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:36:02,208 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:36:02,220 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:36:02,300 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:36:02,361 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:36:02,372 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:36:02,394 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:36:02,401 - multiprocessing - INFO - Rollback performed!
2022-04-30 20:36:02,404 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 20:36:02,416 - multiprocessing - INFO - Connection closed
2022-04-30 20:36:02,426 - multiprocessing - INFO - process shutting down
2022-04-30 20:36:50,428 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:36:50,428 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:36:53,438 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024AD1D59E10>
2022-04-30 20:36:53,439 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024AD1D59E10> by query: select 1 from DUAL
2022-04-30 20:36:53,829 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024AD1D59E10> successfully checked
2022-04-30 20:36:53,829 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:36:53,830 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:36:53,835 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:36:53,858 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:36:53,858 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:36:54,889 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:36:54,905 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:36:54,930 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:36:54,964 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:36:54,972 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:36:54,995 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:36:55,001 - multiprocessing - INFO - Rollback performed!
2022-04-30 20:36:55,004 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 20:36:55,016 - multiprocessing - INFO - Connection closed
2022-04-30 20:36:55,039 - multiprocessing - INFO - process shutting down
2022-04-30 20:38:02,925 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:38:02,925 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:38:05,750 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000019157D49E10>
2022-04-30 20:38:05,751 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000019157D49E10> by query: select 1 from DUAL
2022-04-30 20:38:06,258 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000019157D49E10> successfully checked
2022-04-30 20:38:06,258 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:38:06,259 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:38:06,259 - multiprocessing - INFO - List of files for processing: []
2022-04-30 20:38:06,260 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: local variable 'filename_latest' referenced before assignment
2022-04-30 20:38:06,260 - multiprocessing - INFO - ETL-process stopped
2022-04-30 20:38:06,332 - multiprocessing - INFO - process shutting down
2022-04-30 20:38:28,492 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:38:28,492 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:38:31,411 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000015DAF505E10>
2022-04-30 20:38:31,411 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000015DAF505E10> by query: select 1 from DUAL
2022-04-30 20:38:31,795 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000015DAF505E10> successfully checked
2022-04-30 20:38:31,795 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:38:31,796 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:38:31,801 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:38:31,822 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:38:31,823 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:38:32,798 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:38:32,810 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:38:32,826 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:38:32,857 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:38:32,868 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del;
2022-04-30 20:38:32,890 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00911: неверный символ

2022-04-30 20:38:32,896 - multiprocessing - INFO - Rollback performed!
2022-04-30 20:38:32,918 - multiprocessing - INFO - process shutting down
2022-04-30 20:39:21,969 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:39:21,970 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:39:25,200 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022BC3D89E10>
2022-04-30 20:39:25,200 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022BC3D89E10> by query: select 1 from DUAL
2022-04-30 20:39:25,709 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022BC3D89E10> successfully checked
2022-04-30 20:39:25,710 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:39:25,711 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:39:25,719 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:39:25,772 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:39:25,773 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:39:26,882 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:39:26,894 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:39:26,905 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:39:26,936 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:39:26,945 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del
2022-04-30 20:39:26,982 - multiprocessing - INFO - Query performed
2022-04-30 20:39:26,992 - multiprocessing - INFO - process shutting down
2022-04-30 20:41:22,111 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:41:22,111 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:41:24,988 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C601909E10>
2022-04-30 20:41:24,988 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C601909E10> by query: select 1 from DUAL
2022-04-30 20:41:25,480 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C601909E10> successfully checked
2022-04-30 20:41:25,480 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:41:25,481 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:41:25,487 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:41:25,529 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:41:25,529 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:41:26,448 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:41:26,464 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:41:26,488 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:41:26,579 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:41:26,598 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del
2022-04-30 20:41:26,607 - multiprocessing - INFO - Query performed
2022-04-30 20:41:26,651 - multiprocessing - INFO - process shutting down
2022-04-30 20:42:24,229 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:42:24,230 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:42:27,327 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000018A981C9E10>
2022-04-30 20:42:27,327 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000018A981C9E10> by query: select 1 from DUAL
2022-04-30 20:42:27,753 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000018A981C9E10> successfully checked
2022-04-30 20:42:27,753 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:42:27,754 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:42:27,761 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:42:27,788 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:42:27,789 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:42:28,908 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:42:28,921 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:42:28,945 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:42:28,976 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:42:29,007 - multiprocessing - INFO - Making SQL-query:
delete from demipt2.gold_stg_dim_terminals_del
2022-04-30 20:42:29,017 - multiprocessing - INFO - Query performed
2022-04-30 20:42:29,018 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 20:42:29,097 - multiprocessing - INFO - Query performed
2022-04-30 20:42:29,099 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 20:42:29,116 - multiprocessing - INFO - Connection closed
2022-04-30 20:42:29,127 - multiprocessing - INFO - process shutting down
2022-04-30 20:50:47,681 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:50:47,682 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:50:50,694 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000230F1329E10>
2022-04-30 20:50:50,695 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000230F1329E10> by query: select 1 from DUAL
2022-04-30 20:50:51,214 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000230F1329E10> successfully checked
2022-04-30 20:50:51,214 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:50:51,243 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx']
2022-04-30 20:50:51,248 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 20:50:51,268 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 20:50:51,269 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:50:52,426 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:50:52,439 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:50:52,458 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:50:52,489 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:50:52,502 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 20:50:52,511 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,511 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 20:50:52,519 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,519 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 20:50:52,687 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,688 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 20:50:52,698 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,698 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 20:50:52,763 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,764 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 20:50:52,775 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,776 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 20:50:52,796 - multiprocessing - INFO - Query performed
2022-04-30 20:50:52,808 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_02032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_02032021.xlsx.backup'
2022-04-30 20:50:52,820 - multiprocessing - INFO - Connection closed
2022-04-30 20:50:52,832 - multiprocessing - INFO - process shutting down
2022-04-30 20:52:23,808 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:52:23,809 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:52:26,656 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022845C45E10>
2022-04-30 20:52:26,656 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022845C45E10> by query: select 1 from DUAL
2022-04-30 20:52:27,043 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022845C45E10> successfully checked
2022-04-30 20:52:27,043 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:52:27,044 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:52:27,049 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:52:27,072 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:52:27,072 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 20:52:27,072 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 20:52:27,087 - multiprocessing - INFO - Connection closed
2022-04-30 20:52:27,134 - multiprocessing - INFO - process shutting down
2022-04-30 20:54:41,486 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:54:41,486 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:54:44,333 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A2BF395E10>
2022-04-30 20:54:44,334 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A2BF395E10> by query: select 1 from DUAL
2022-04-30 20:54:44,708 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A2BF395E10> successfully checked
2022-04-30 20:54:44,708 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:54:44,709 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx', 'terminals_02032021.xlsx', 'terminals_03032021.xlsx']
2022-04-30 20:54:44,717 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 20:54:44,735 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 20:54:44,735 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:54:45,674 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:54:45,686 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:54:45,707 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:54:45,738 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:54:45,751 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 20:54:45,758 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,758 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 20:54:45,764 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,765 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 20:54:45,773 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,773 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 20:54:45,785 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,785 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 20:54:45,791 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,792 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 20:54:45,799 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,799 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 20:54:45,805 - multiprocessing - INFO - Query performed
2022-04-30 20:54:45,816 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 20:54:45,831 - multiprocessing - INFO - Connection closed
2022-04-30 20:54:45,841 - multiprocessing - INFO - process shutting down
2022-04-30 20:57:36,000 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:57:36,001 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:57:38,899 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002219D785E10>
2022-04-30 20:57:38,900 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002219D785E10> by query: select 1 from DUAL
2022-04-30 20:57:39,548 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002219D785E10> successfully checked
2022-04-30 20:57:39,549 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:57:39,550 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 20:57:39,558 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 20:57:39,579 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 20:57:39,580 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 20:57:40,927 - multiprocessing - INFO - Created dataframe:
2022-04-30 20:57:40,944 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 20:57:40,964 - multiprocessing - INFO - Staging was cleared!
2022-04-30 20:57:41,003 - multiprocessing - INFO - Data was inserted!
2022-04-30 20:57:41,014 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 20:57:41,021 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,022 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 20:57:41,028 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,028 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 20:57:41,036 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,037 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 20:57:41,045 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,045 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 20:57:41,051 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,051 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 20:57:41,059 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,059 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 20:57:41,068 - multiprocessing - INFO - Query performed
2022-04-30 20:57:41,086 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 20:57:41,099 - multiprocessing - INFO - Connection closed
2022-04-30 20:57:41,115 - multiprocessing - INFO - process shutting down
2022-04-30 20:58:54,484 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:58:54,484 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:58:57,184 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001B43B5C5E10>
2022-04-30 20:58:57,185 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001B43B5C5E10> by query: select 1 from DUAL
2022-04-30 20:58:57,655 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001B43B5C5E10> successfully checked
2022-04-30 20:58:57,655 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:58:57,656 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:58:57,656 - multiprocessing - INFO - List of files for processing: []
2022-04-30 20:58:57,657 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: local variable 'filename_latest' referenced before assignment
2022-04-30 20:58:57,657 - multiprocessing - INFO - ETL-process stopped
2022-04-30 20:58:57,739 - multiprocessing - INFO - process shutting down
2022-04-30 20:59:53,336 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 20:59:53,336 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 20:59:57,186 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001EACBFE5E10>
2022-04-30 20:59:57,186 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001EACBFE5E10> by query: select 1 from DUAL
2022-04-30 20:59:57,579 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001EACBFE5E10> successfully checked
2022-04-30 20:59:57,579 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:59:57,580 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 20:59:57,580 - multiprocessing - INFO - List of files for processing: []
2022-04-30 20:59:57,581 - multiprocessing - INFO - The actual file: 
2022-04-30 20:59:57,602 - multiprocessing - INFO - Actual date: 0001-01-01
2022-04-30 20:59:57,603 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 20:59:57,603 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 20:59:57,619 - multiprocessing - INFO - Connection closed
2022-04-30 20:59:57,786 - multiprocessing - INFO - process shutting down
2022-04-30 21:00:30,762 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:00:30,762 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:00:34,112 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000029EE38D9E10>
2022-04-30 21:00:34,112 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000029EE38D9E10> by query: select 1 from DUAL
2022-04-30 21:00:34,757 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000029EE38D9E10> successfully checked
2022-04-30 21:00:34,757 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:00:34,758 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:00:34,819 - multiprocessing - INFO - process shutting down
2022-04-30 21:01:24,238 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:01:24,238 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:01:27,437 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A9A4EF1E10>
2022-04-30 21:01:27,437 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A9A4EF1E10> by query: select 1 from DUAL
2022-04-30 21:01:28,346 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A9A4EF1E10> successfully checked
2022-04-30 21:01:28,347 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:01:28,347 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 21:01:28,353 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 21:01:28,416 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 21:01:28,437 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 21:01:29,473 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:01:29,485 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск       г. Новоуральск, ул. Степана Шутова, д. 37
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9111           POS             Тюмень                 г. Тюмень, Шушенская ул., д. 14
143       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
144       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
145       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
146       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
147       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
148       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
149       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
150       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:01:29,513 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:01:29,544 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:01:29,562 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:01:29,572 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,572 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:01:29,583 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,584 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:01:29,597 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,598 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:01:29,606 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,606 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:01:29,614 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,614 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:01:29,623 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,623 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:01:29,630 - multiprocessing - INFO - Query performed
2022-04-30 21:01:29,648 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 21:01:29,664 - multiprocessing - INFO - Connection closed
2022-04-30 21:01:29,677 - multiprocessing - INFO - process shutting down
2022-04-30 21:02:33,259 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:02:33,260 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:02:36,314 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002A714355E10>
2022-04-30 21:02:36,315 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002A714355E10> by query: select 1 from DUAL
2022-04-30 21:02:36,862 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002A714355E10> successfully checked
2022-04-30 21:02:36,862 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:02:36,863 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:02:36,869 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:02:36,891 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:02:36,891 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:02:37,914 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:02:37,931 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:02:37,943 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:02:37,985 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:02:37,996 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:02:38,003 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,003 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:02:38,009 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,009 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:02:38,017 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,017 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:02:38,024 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,024 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:02:38,095 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:02:38,106 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:02:38,106 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:02:38,114 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,115 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:02:38,121 - multiprocessing - INFO - Query performed
2022-04-30 21:02:38,131 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 21:02:38,145 - multiprocessing - INFO - Connection closed
2022-04-30 21:02:38,162 - multiprocessing - INFO - process shutting down
2022-04-30 21:03:27,068 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:03:27,068 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:03:30,049 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002AB31D65E10>
2022-04-30 21:03:30,050 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002AB31D65E10> by query: select 1 from DUAL
2022-04-30 21:03:30,558 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002AB31D65E10> successfully checked
2022-04-30 21:03:30,558 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:03:30,559 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:03:30,565 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:03:30,588 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:03:30,589 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:03:31,791 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:03:31,803 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:03:31,816 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:03:31,852 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:03:31,864 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:03:31,873 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,874 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:03:31,882 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,882 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:03:31,893 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,893 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:03:31,902 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,902 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:03:31,928 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:03:31,942 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:03:31,942 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:03:31,952 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,952 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:03:31,961 - multiprocessing - INFO - Query performed
2022-04-30 21:03:31,972 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 21:03:31,986 - multiprocessing - INFO - Connection closed
2022-04-30 21:03:31,995 - multiprocessing - INFO - process shutting down
2022-04-30 21:05:13,167 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:05:13,167 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:05:15,944 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000025A1C509E10>
2022-04-30 21:05:15,944 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000025A1C509E10> by query: select 1 from DUAL
2022-04-30 21:05:16,477 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000025A1C509E10> successfully checked
2022-04-30 21:05:16,478 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:05:16,479 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:05:16,484 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:05:16,521 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:05:16,522 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:05:17,358 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:05:17,374 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:05:17,394 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:05:17,425 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:05:17,445 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:05:17,452 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,452 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:05:17,458 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,458 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:05:17,466 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,466 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:05:17,472 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,473 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:05:17,494 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:05:17,505 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:05:17,505 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:05:17,512 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,513 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:05:17,519 - multiprocessing - INFO - Query performed
2022-04-30 21:05:17,538 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 21:05:17,553 - multiprocessing - INFO - Connection closed
2022-04-30 21:05:17,562 - multiprocessing - INFO - process shutting down
2022-04-30 21:05:57,818 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:05:57,818 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:06:00,862 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A0BB385E10>
2022-04-30 21:06:00,862 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A0BB385E10> by query: select 1 from DUAL
2022-04-30 21:06:01,370 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A0BB385E10> successfully checked
2022-04-30 21:06:01,370 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:06:01,371 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:06:01,377 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:06:01,418 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:06:01,418 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:06:02,260 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:06:02,275 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:06:02,300 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:06:02,377 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:06:02,390 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:06:02,400 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,400 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:06:02,409 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,410 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:06:02,420 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,420 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:06:02,431 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,431 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:06:02,457 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:06:02,473 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:06:02,473 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:06:02,483 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,483 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:06:02,499 - multiprocessing - INFO - Query performed
2022-04-30 21:06:02,515 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 21:06:02,531 - multiprocessing - INFO - Connection closed
2022-04-30 21:06:02,564 - multiprocessing - INFO - process shutting down
2022-04-30 21:08:05,176 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:08:05,176 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:08:08,278 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000017E8F725E10>
2022-04-30 21:08:08,278 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000017E8F725E10> by query: select 1 from DUAL
2022-04-30 21:08:08,669 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000017E8F725E10> successfully checked
2022-04-30 21:08:08,670 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:08:08,671 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:08:08,676 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:08:08,697 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:08:08,697 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:08:09,528 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:08:09,541 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск        г. Новоуральск, ул. Степана Шутова, д. 3
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера    г. Малая Вишера, 2-й Щемиловский пер., д. 18
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149      AAAAAA           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:08:09,555 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:08:09,585 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:08:09,594 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:08:09,601 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,601 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:08:09,607 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,608 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:08:09,615 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,616 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:08:09,622 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,623 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:08:09,642 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:08:09,653 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:08:09,653 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:08:09,660 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,660 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:08:09,667 - multiprocessing - INFO - Query performed
2022-04-30 21:08:09,679 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_03032021.xlsx.backup'
2022-04-30 21:08:09,691 - multiprocessing - INFO - Connection closed
2022-04-30 21:08:09,701 - multiprocessing - INFO - process shutting down
2022-04-30 21:10:22,006 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:10:22,006 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:10:25,045 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000027027C05E10>
2022-04-30 21:10:25,046 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000027027C05E10> by query: select 1 from DUAL
2022-04-30 21:10:25,427 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000027027C05E10> successfully checked
2022-04-30 21:10:25,427 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:10:25,429 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:10:25,434 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:10:25,452 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:10:25,453 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:10:25,453 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 21:10:25,491 - multiprocessing - INFO - process shutting down
2022-04-30 21:10:42,491 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:10:42,491 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:10:45,329 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001616F685E10>
2022-04-30 21:10:45,329 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001616F685E10> by query: select 1 from DUAL
2022-04-30 21:10:45,852 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001616F685E10> successfully checked
2022-04-30 21:10:45,853 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:10:45,854 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:10:45,859 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:10:45,898 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:10:45,899 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:10:46,787 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:10:46,793 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1099           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 21:10:46,802 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:10:46,814 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:10:46,829 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:10:46,836 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,837 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:10:46,843 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,843 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:10:46,851 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,852 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:10:46,859 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,859 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:10:46,866 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,866 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:10:46,873 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,874 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:10:46,881 - multiprocessing - INFO - Query performed
2022-04-30 21:10:46,892 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 21:10:46,904 - multiprocessing - INFO - Connection closed
2022-04-30 21:10:46,976 - multiprocessing - INFO - process shutting down
2022-04-30 21:12:07,132 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:12:07,132 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:12:09,949 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001EBA61E5E10>
2022-04-30 21:12:09,949 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001EBA61E5E10> by query: select 1 from DUAL
2022-04-30 21:12:10,452 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001EBA61E5E10> successfully checked
2022-04-30 21:12:10,452 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:12:10,453 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 21:12:10,459 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 21:12:10,497 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 21:12:10,498 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 21:12:11,504 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:12:11,508 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1099           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1203           ATM   Стерлитамак    г. Стерлитамак, Электрозаводская ул., д. 3
2022-04-30 21:12:11,518 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:12:11,530 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:12:11,553 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:12:11,561 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,562 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:12:11,570 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,570 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:12:11,580 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,580 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:12:11,589 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,589 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:12:11,598 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,598 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:12:11,607 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,607 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:12:11,616 - multiprocessing - INFO - Query performed
2022-04-30 21:12:11,628 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 21:12:11,641 - multiprocessing - INFO - Connection closed
2022-04-30 21:12:11,652 - multiprocessing - INFO - process shutting down
2022-04-30 21:13:29,533 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:13:29,534 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:13:32,632 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000283AC765E10>
2022-04-30 21:13:32,632 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000283AC765E10> by query: select 1 from DUAL
2022-04-30 21:13:33,057 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000283AC765E10> successfully checked
2022-04-30 21:13:33,057 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:13:33,058 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:13:33,063 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:13:33,084 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:13:33,084 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:13:34,286 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:13:34,292 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1099           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1203           ATM       DDDDDDD    г. Стерлитамак, Электрозаводская ул., д. 3
2022-04-30 21:13:34,302 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:13:34,314 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:13:34,324 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:13:34,332 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,332 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:13:34,341 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,341 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:13:34,351 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,351 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:13:34,361 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,361 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:13:34,370 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,370 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:13:34,379 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,379 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:13:34,388 - multiprocessing - INFO - Query performed
2022-04-30 21:13:34,409 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 21:13:34,427 - multiprocessing - INFO - Connection closed
2022-04-30 21:13:34,439 - multiprocessing - INFO - process shutting down
2022-04-30 21:17:20,953 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:17:20,954 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:17:24,195 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000026643C25E10>
2022-04-30 21:17:24,195 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000026643C25E10> by query: select 1 from DUAL
2022-04-30 21:17:24,847 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000026643C25E10> successfully checked
2022-04-30 21:17:24,847 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:17:24,849 - multiprocessing - INFO - List of files for processing: ['terminals_04032021.xlsx']
2022-04-30 21:17:24,854 - multiprocessing - INFO - The actual file: terminals_04032021.xlsx
2022-04-30 21:17:24,874 - multiprocessing - INFO - Actual date: 2021-03-04
2022-04-30 21:17:24,874 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:17:25,698 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:17:25,702 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1099           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 21:17:25,712 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:17:25,725 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:17:25,736 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:17:25,744 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,744 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:17:25,753 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,753 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:17:25,762 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,762 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:17:25,772 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,772 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:17:25,797 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:17:25,815 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:17:25,815 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:17:25,824 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,824 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:17:25,833 - multiprocessing - INFO - Query performed
2022-04-30 21:17:25,845 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_04032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_04032021.xlsx
2022-04-30 21:17:25,862 - multiprocessing - INFO - Connection closed
2022-04-30 21:17:25,873 - multiprocessing - INFO - process shutting down
2022-04-30 21:18:43,224 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:18:43,225 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:18:46,345 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000019CA9F01E10>
2022-04-30 21:18:46,345 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000019CA9F01E10> by query: select 1 from DUAL
2022-04-30 21:18:46,840 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000019CA9F01E10> successfully checked
2022-04-30 21:18:46,841 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:18:46,842 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 21:18:46,867 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 21:18:46,885 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 21:18:46,885 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:18:48,061 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:18:48,065 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1099           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2        5656           456            54                                          4564
2022-04-30 21:18:48,073 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:18:48,148 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:18:48,182 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:18:48,189 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,189 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:18:48,195 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,195 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:18:48,203 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,203 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:18:48,215 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,215 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:18:48,235 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:18:48,246 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:18:48,246 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:18:48,254 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,254 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:18:48,261 - multiprocessing - INFO - Query performed
2022-04-30 21:18:48,270 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_05032021.xlsx
2022-04-30 21:18:48,282 - multiprocessing - INFO - Connection closed
2022-04-30 21:18:48,295 - multiprocessing - INFO - process shutting down
2022-04-30 21:24:05,601 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:24:05,602 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:24:08,551 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000223C4F05E10>
2022-04-30 21:24:08,551 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000223C4F05E10> by query: select 1 from DUAL
2022-04-30 21:24:08,975 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000223C4F05E10> successfully checked
2022-04-30 21:24:08,975 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:24:08,976 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:24:08,980 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:24:09,001 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:24:09,002 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:24:09,901 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:24:09,908 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0      1марта           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:24:09,917 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:24:09,946 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-12899: значение для столбца "DEMIPT2"."GOLD_STG_DIM_TERMINALS"."TERMINAL_ID" слишком велико (фактическое: 11, максимальное: 10)

2022-04-30 21:24:09,956 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:24:09,963 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,964 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:24:09,970 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,970 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:24:09,977 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,978 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:24:09,984 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,985 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:24:09,991 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,991 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:24:09,998 - multiprocessing - INFO - Query performed
2022-04-30 21:24:09,998 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:24:10,004 - multiprocessing - INFO - Query performed
2022-04-30 21:24:10,017 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 21:24:10,031 - multiprocessing - INFO - Connection closed
2022-04-30 21:24:10,042 - multiprocessing - INFO - process shutting down
2022-04-30 21:29:19,379 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:29:19,379 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:29:22,051 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002455DEE9E10>
2022-04-30 21:29:22,051 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002455DEE9E10> by query: select 1 from DUAL
2022-04-30 21:29:22,575 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002455DEE9E10> successfully checked
2022-04-30 21:29:22,575 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:29:22,576 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:29:22,582 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:29:22,623 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:29:22,624 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:29:23,506 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:29:23,511 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0      1марта           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:29:23,520 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:29:23,541 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-12899: значение для столбца "DEMIPT2"."GOLD_STG_DIM_TERMINALS"."TERMINAL_ID" слишком велико (фактическое: 11, максимальное: 10)

2022-04-30 21:29:23,547 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:29:23,554 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,554 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:29:23,561 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,561 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:29:23,569 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,569 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:29:23,583 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,584 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:29:23,591 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,591 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:29:23,597 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,598 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:29:23,605 - multiprocessing - INFO - Query performed
2022-04-30 21:29:23,612 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 21:29:23,628 - multiprocessing - INFO - Connection closed
2022-04-30 21:29:23,688 - multiprocessing - INFO - process shutting down
2022-04-30 21:30:17,695 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:30:17,695 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:30:20,681 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000025D3D201E10>
2022-04-30 21:30:20,681 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000025D3D201E10> by query: select 1 from DUAL
2022-04-30 21:30:21,150 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000025D3D201E10> successfully checked
2022-04-30 21:30:21,151 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:30:21,152 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:30:21,157 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:30:21,197 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:30:21,197 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:30:22,276 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:30:22,290 - multiprocessing - INFO - 
    terminal_id terminal_type      terminal_city                                terminal_address
0         A1096           ATM           Кемерово    г. Кемерово, 1-й Электрозаводский пер., д. 3
1         A1099           ATM             Баймак            г. Баймак, Б. Лёвшинский пер., д. 37
2         A1203           ATM        Стерлитамак      г. Стерлитамак, Электрозаводская ул., д. 3
3         A1553           ATM            Воронеж              г. Воронеж, пр. Энтузиастов, д. 44
4         A1641           ATM             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
5         A1642           ATM     Новокуйбышевск   г. Новокуйбышевск, 1-й Щипковский пер., д. 19
6         A1882           ATM            Иркутск                  г. Иркутск, Юровская ул., д. 3
7         A2293           ATM          Краснодар                  г. Краснодар, Южный пр., д. 20
8         A2674           ATM              Истра                      г. Истра, ул. Юности, д. 8
9         A2758           ATM          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
10        A2822           ATM              Томск                  г. Томск, Юрловский пр., д. 22
11        A3174           ATM             Москва           г. Москва, 1-й Щемиловский пер., д. 8
12        A3231           ATM             Москва                   г. Москва, ул. Щепкина, д. 17
13        A3275           ATM           Петухово             г. Петухово, Элеваторная ул., д. 39
14        A3618           ATM       Малая Вишера         г. Малая Вишера, Элеваторная ул., д. 39
15        A3763           ATM              Лиски                     г. Лиски, пл. Юности, д. 38
16        A3786           ATM            Воронеж           г. Воронеж, 4-й Щипковский пер., д. 7
17        A3800           ATM            Воронеж             г. Воронеж, М. Юшуньская ул., д. 25
18        A3939           ATM            Воронеж                  г. Воронеж, ул. Щепкина, д. 17
19        A3961           ATM              Бийск           г. Бийск, 2-й Щемиловский пер., д. 18
20        A4274           ATM               Тула                г. Тула, Южнопортовая ул., д. 31
21        A4322           ATM        Новокузнецк                г. Новокузнецк, ул. Щипок, д. 17
22        A4352           ATM          Кировград             г. Кировград, Щёлковский пр., д. 37
23        A4418           ATM             Москва               г. Москва, пр. Энтузиастов, д. 26
24        A4902           ATM           Тольятти          г. Тольятти, ул. Степана Шутова, д. 42
25        A4956           ATM             Баймак               г. Баймак, Электродный пр., д. 14
26        A5083           ATM             Донецк            г. Донецк, ул. Степана Шутова, д. 42
27        A5128           ATM               Тула                      г. Тула, ул. Шухова, д. 22
28        A5188           ATM      Верхнеуральск       г. Верхнеуральск, Элеваторный пер., д. 24
29        A5235           ATM      Верхняя Пышма             г. Верхняя Пышма, пл. Юности, д. 38
30        A5301           ATM            Воронеж              г. Воронеж, Элеваторная ул., д. 39
31        A5308           ATM    Нижний Новгород      г. Нижний Новгород, пр. Энтузиастов, д. 44
32        A5532           ATM             Усмань          г. Усмань, Электрозаводская ул., д. 45
33        A5587           ATM              Томск                 г. Томск, Щёлковский пр., д. 37
34        A5602           ATM             Ворсма           г. Ворсма, 2-й Южнопортовый пр., д. 4
35        A5652           ATM             Кашира              г. Кашира, Южнопортовая ул., д. 31
36        A5830           ATM           Харабали            г. Харабали, Щербаковская ул., д. 36
37        A6069           ATM          Махачкала        г. Махачкала, Электрозаводская ул., д. 3
38        A6204           ATM          Котельнич       г. Котельнич, 1-й Южнопортовый пр., д. 26
39        A6387           ATM             Кашира                   г. Кашира, Юровская ул., д. 3
40        A6481           ATM       Благовещенск           г. Благовещенск, Шушенская ул., д. 14
41        A6603           ATM       Усть-Джегута           г. Усть-Джегута, Юрьевская ул., д. 14
42        A6659           ATM     Новокуйбышевск         г. Новокуйбышевск, Щукинская ул., д. 26
43        A6672           ATM      Верхнеуральск       г. Верхнеуральск, Щербаковская ул., д. 36
44        A6714           ATM            Ангарск              г. Ангарск, Элеваторная ул., д. 39
45        A6755           ATM          Котельнич                  г. Котельнич, ул. Шухова, д. 9
46        A6766           ATM  Каменск-Уральский     г. Каменск-Уральский, Щёлковский пр., д. 37
47        A6773           ATM             Донецк              г. Донецк, Элеваторный пер., д. 24
48        A6821           ATM       Малая Вишера              г. Малая Вишера, пл. Юности, д. 38
49        A7123           ATM            Иркутск                г. Иркутск, Щукинская ул., д. 26
50        A7275           ATM              Бийск             г. Бийск, ул. Степана Шутова, д. 37
51        A7368           ATM          Челябинск         г. Челябинск, Энергетический пр., д. 38
52        A7483           ATM          Краснодар                 г. Краснодар, ул. Юности, д. 10
53        A7709           ATM             Москва              г. Москва, Элеваторный пер., д. 24
54        A7800           ATM        Новоуральск   г. Новоуральск, ул. Сергея Эйзенштейна, д. 41
55        A7859           ATM          Жигулёвск           г. Жигулёвск, Элеваторный пер., д. 26
56        A7919           ATM       Благовещенск        г. Благовещенск, Щербаковская ул., д. 36
57        A7985           ATM           Кемерово                   г. Кемерово, ул. Щипок, д. 17
58        A8107           ATM           Знаменск          г. Знаменск, 4-й Щипковский пер., д. 7
59        A8244           ATM             Ворсма               г. Ворсма, М. Юшуньская ул., д. 1
60        A8312           ATM    Санкт-Петербург        г. Санкт-Петербург, Щукинская ул., д. 26
61        A8367           ATM     Ростов-на-Дону           г. Ростов-на-Дону, ул. Щепкина, д. 17
62        A8454           ATM              Бийск               г. Бийск, Щербаковская ул., д. 36
63        A8616           ATM           Харабали                  г. Харабали, пл. Юности, д. 38
64        A8676           ATM             Кашира                     г. Кашира, ул. Щипок, д. 17
65        A8725           ATM            Воронеж              г. Воронеж, М. Юшуньская ул., д. 1
66        A8966           ATM        Новоуральск                г. Новоуральск, Южный пр., д. 44
67        A9007           ATM        Новосибирск          г. Новосибирск, Электродная ул., д. 18
68        A9052           ATM             Баймак               г. Баймак, Элеваторная ул., д. 39
69        A9109           ATM          Котельнич         г. Котельнич, Б. Лёвшинский пер., д. 37
70        A9191           ATM              Лиски            г. Лиски, 1-й Щемиловский пер., д. 8
71        A9257           ATM          Челябинск        г. Челябинск, Электрозаводская ул., д. 3
72        A9314           ATM          Кировград       г. Кировград, 2-й Щемиловский пер., д. 16
73        A9547           ATM  Каменск-Уральский          г. Каменск-Уральский, ул. Щипок, д. 17
74        A9748           ATM      Верхняя Пышма       г. Верхняя Пышма, М. Юшуньская ул., д. 25
75        A9878           ATM             Тюмень            г. Тюмень, ул. Степана Шутова, д. 37
76        P1107           POS       Усть-Джегута       г. Усть-Джегута, Электролитный пр., д. 49
77        P1113           POS     Новокуйбышевск       г. Новокуйбышевск, М. Юшуньская ул., д. 1
78        P1178           POS    Нижний Новгород     г. Нижний Новгород, М. Юшуньская ул., д. 25
79        P1201           POS            Иркутск           г. Иркутск, Энергетическая ул., д. 44
80        P1203           POS             Москва            г. Москва, ул. Степана Шутова, д. 37
81        P1288           POS            Бабаево            г. Бабаево, Электролитный пр., д. 49
82        P1397           POS       Усть-Джегута               г. Усть-Джегута, Южный пр., д. 20
83        P1459           POS           Тольятти            г. Тольятти, Элеваторный пер., д. 35
84        P1550           POS              Истра             г. Истра, ул. Степана Шутова, д. 42
85        P1594           POS           Петухово               г. Петухово, Шушенская ул., д. 14
86        P1778           POS             Ворсма                    г. Ворсма, пл. Юности, д. 38
87        P1887           POS       Благовещенск             г. Благовещенск, Юровская ул., д. 3
88        P1949           POS          Кировград                г. Кировград, ул. Щепкина, д. 44
89        P2046           POS               Тула                       г. Тула, ул. Шухова, д. 9
90        P2230           POS             Москва          г. Москва, 2-й Щемиловский пер., д. 16
91        P2250           POS        Новосибирск         г. Новосибирск, Электролитный пр., д. 5
92        P2285           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 44
93        P2585           POS             Москва                     г. Москва, ул. Юности, д. 8
94        P2829           POS          Челябинск     г. Челябинск, ул. Сергея Эйзенштейна, д. 41
95        P3128           POS          Жигулёвск           г. Жигулёвск, М. Юшуньская ул., д. 25
96        P3149           POS            Ангарск            г. Ангарск, Электролитный пр., д. 49
97        P3218           POS         Светлоград          г. Светлоград, Южнопортовая ул., д. 31
98        P3292           POS          Махачкала                 г. Махачкала, ул. Юности, д. 10
99        P3317           POS        Новокузнецк     г. Новокузнецк, 2-й Щемиловский пер., д. 18
100       P3451           POS      Верхнеуральск       г. Верхнеуральск, Электролитный пр., д. 5
101       P3462           POS           Тольятти            г. Тольятти, Электролитный пр., д. 5
102       P3808           POS             Москва      г. Москва, 1-й Электрозаводский пер., д. 3
103       P3814           POS           Тольятти          г. Тольятти, Энергетический пр., д. 38
104       P4478           POS     Ростов-на-Дону  г. Ростов-на-Дону, 2-й Щемиловский пер., д. 18
105       P4705           POS        Новосибирск          г. Новосибирск, Электродная ул., д. 18
106       P4744           POS      Верхняя Пышма        г. Верхняя Пышма, пр. Энтузиастов, д. 44
107       P4829           POS           Тольятти            г. Тольятти, Щербаковская ул., д. 36
108       P4853           POS            Воронеж              г. Воронеж, Электродная ул., д. 18
109       P4910           POS        Стерлитамак            г. Стерлитамак, Юрловский пр., д. 22
110       P5262           POS    Санкт-Петербург           г. Санкт-Петербург, ул. Шухова, д. 22
111       P5456           POS             Москва                    г. Москва, ул. Шухова, д. 22
112       P5758           POS            Бабаево                г. Бабаево, Шушенская ул., д. 14
113       P5839           POS             Москва          г. Москва, 1-й Южнопортовый пр., д. 26
114       P5893           POS          Махачкала           г. Махачкала, Элеваторный пер., д. 26
115       P5930           POS             Москва        г. Москва, ул. Сергея Эйзенштейна, д. 41
116       P6147           POS           Знаменск                  г. Знаменск, ул. Юности, д. 10
117       P6162           POS              Истра            г. Истра, Электрозаводская ул., д. 3
118       P6335           POS             Москва              г. Москва, М. Юшуньская ул., д. 25
119       P6541           POS  Каменск-Уральский   г. Каменск-Уральский, Электролитный пр., д. 5
120       P6759           POS             Москва                 г. Москва, Шушенская ул., д. 14
121       P6876           POS            Бабаево           г. Бабаево, 4-й Щипковский пер., д. 7
122       P6934           POS       Малая Вишера         г. Малая Вишера, пр. Энтузиастов, д. 44
123       P6946           POS              Лиски                      г. Лиски, Южный пр., д. 20
124       P6949           POS         Светлоград       г. Светлоград, 1-й Щемиловский пер., д. 8
125       P6958           POS             Усмань               г. Усмань, Электродная ул., д. 18
126       P7403           POS           Петухово          г. Петухово, ул. Степана Шутова, д. 42
127       P7451           POS        Новосибирск              г. Новосибирск, ул. Щепкина, д. 17
128       P7575           POS           Харабали    г. Харабали, 1-й Электрозаводский пер., д. 3
129       P7869           POS     Ростов-на-Дону         г. Ростов-на-Дону, Шушенская ул., д. 14
130       P8072           POS            Ангарск         г. Ангарск, 2-й Щемиловский пер., д. 18
131       P8114           POS             Донецк                    г. Донецк, пл. Юности, д. 27
132       P8225           POS    Санкт-Петербург      г. Санкт-Петербург, пр. Энтузиастов, д. 44
133       P8262           POS          Краснодар        г. Краснодар, 2-й Южнопортовый пр., д. 4
134       P8410           POS            Воронеж                  г. Воронеж, Юровская ул., д. 3
135       P8663           POS           Кемерово                  г. Кемерово, пл. Юности, д. 27
136       P8667           POS             Тюмень           г. Тюмень, Электрозаводская ул., д. 3
137       P8712           POS        Новоуральск       г. Новоуральск, Б. Лёвшинский пер., д. 21
138       P8714           POS         Светлоград          г. Светлоград, Элеваторный пер., д. 24
139       P8946           POS           Тольятти        г. Тольятти, 2-й Щемиловский пер., д. 16
140       P9037           POS        Новосибирск               г. Новосибирск, ул. Юности, д. 10
141       P9098           POS        Стерлитамак              г. Стерлитамак, Юровская ул., д. 3
142       P9464           POS            Воронеж                    г. Воронеж, Южный пр., д. 20
143       P9579           POS             Москва                   г. Москва, Юровская ул., д. 3
144       P9606           POS             Тюмень              г. Тюмень, Щербаковская ул., д. 36
145       P9862           POS        Новокузнецк       г. Новокузнецк, Б. Лёвшинский пер., д. 21
146       P9889           POS             Усмань                 г. Усмань, Шушенская ул., д. 14
147       P9974           POS              Томск                     г. Томск, ул. Шухова, д. 22
148       P9977           POS    Нижний Новгород      г. Нижний Новгород, М. Юшуньская ул., д. 1
149       P9978           POS           Знаменск            г. Знаменск, Электролитный пр., д. 5
2022-04-30 21:30:22,315 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:30:22,357 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:30:22,380 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:30:22,388 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,388 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:30:22,396 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,397 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:30:22,407 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,407 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:30:22,416 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,416 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:30:22,424 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,424 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:30:22,434 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,434 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:30:22,442 - multiprocessing - INFO - Query performed
2022-04-30 21:30:22,456 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 21:30:22,470 - multiprocessing - INFO - Connection closed
2022-04-30 21:30:22,482 - multiprocessing - INFO - process shutting down
2022-04-30 21:31:42,971 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:31:42,972 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:31:45,981 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001EDEA705E10>
2022-04-30 21:31:45,982 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001EDEA705E10> by query: select 1 from DUAL
2022-04-30 21:31:46,396 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001EDEA705E10> successfully checked
2022-04-30 21:31:46,396 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:31:46,397 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:31:46,427 - multiprocessing - INFO - process shutting down
2022-04-30 21:31:59,391 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:31:59,391 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:32:02,561 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000204BC625E10>
2022-04-30 21:32:02,561 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000204BC625E10> by query: select 1 from DUAL
2022-04-30 21:32:03,154 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000204BC625E10> successfully checked
2022-04-30 21:32:03,155 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:32:03,156 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:32:03,160 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:32:03,182 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:32:03,182 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 21:32:03,182 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 21:32:03,210 - multiprocessing - INFO - process shutting down
2022-04-30 21:33:33,073 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:33:33,074 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:33:36,200 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001B713445E10>
2022-04-30 21:33:36,200 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001B713445E10> by query: select 1 from DUAL
2022-04-30 21:33:36,587 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001B713445E10> successfully checked
2022-04-30 21:33:36,588 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:33:36,588 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:33:36,593 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:33:36,613 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:33:36,613 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 21:33:36,613 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 21:33:36,634 - multiprocessing - INFO - process shutting down
2022-04-30 21:33:46,319 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:33:46,320 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:33:49,230 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A98D045E10>
2022-04-30 21:33:49,231 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A98D045E10> by query: select 1 from DUAL
2022-04-30 21:33:49,605 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A98D045E10> successfully checked
2022-04-30 21:33:49,606 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:33:49,607 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:33:49,612 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:33:49,635 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:33:49,635 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:33:50,493 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:33:50,499 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0      1марта           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:33:50,510 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:33:50,536 - multiprocessing - INFO - Data was not inserted! Exception: java.sql.BatchUpdateException: ORA-12899: значение для столбца "DEMIPT2"."GOLD_STG_DIM_TERMINALS"."TERMINAL_ID" слишком велико (фактическое: 11, максимальное: 10)

2022-04-30 21:33:50,545 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:33:50,554 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,555 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:33:50,564 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,564 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:33:50,574 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,575 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:33:50,587 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,587 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:33:50,596 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,596 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:33:50,605 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,605 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:33:50,614 - multiprocessing - INFO - Query performed
2022-04-30 21:33:50,626 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 21:33:50,639 - multiprocessing - INFO - Connection closed
2022-04-30 21:33:50,650 - multiprocessing - INFO - process shutting down
2022-04-30 21:36:27,251 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:36:27,252 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:36:30,338 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000022B25755E10>
2022-04-30 21:36:30,338 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000022B25755E10> by query: select 1 from DUAL
2022-04-30 21:36:30,834 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000022B25755E10> successfully checked
2022-04-30 21:36:30,835 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:36:30,836 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:36:30,841 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:36:30,894 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:36:30,894 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:36:32,108 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:36:32,113 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:36:32,120 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:36:32,129 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:36:32,137 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:36:32,143 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,144 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:36:32,150 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,150 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:36:32,158 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,158 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:36:32,166 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,166 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:36:32,173 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,173 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:36:32,180 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,180 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:36:32,186 - multiprocessing - INFO - Query performed
2022-04-30 21:36:32,198 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 21:36:32,211 - multiprocessing - INFO - Connection closed
2022-04-30 21:36:32,222 - multiprocessing - INFO - process shutting down
2022-04-30 21:36:39,562 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:36:39,563 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:36:43,597 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000166AC851E10>
2022-04-30 21:36:43,597 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000166AC851E10> by query: select 1 from DUAL
2022-04-30 21:36:44,147 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000166AC851E10> successfully checked
2022-04-30 21:36:44,147 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:36:44,148 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:36:44,200 - multiprocessing - INFO - process shutting down
2022-04-30 21:37:51,405 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:37:51,405 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:37:54,422 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000017A1E885E10>
2022-04-30 21:37:54,422 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000017A1E885E10> by query: select 1 from DUAL
2022-04-30 21:37:54,921 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000017A1E885E10> successfully checked
2022-04-30 21:37:54,921 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:37:54,922 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 21:37:54,927 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 21:37:54,948 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 21:37:54,949 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 21:37:56,105 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:37:56,112 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 21:37:56,120 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:37:56,130 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:37:56,147 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:37:56,154 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,154 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:37:56,162 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,163 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:37:56,171 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,171 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:37:56,180 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,180 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:37:56,187 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,187 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:37:56,195 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,195 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:37:56,201 - multiprocessing - INFO - Query performed
2022-04-30 21:37:56,211 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 21:37:56,225 - multiprocessing - INFO - Connection closed
2022-04-30 21:37:56,250 - multiprocessing - INFO - process shutting down
2022-04-30 21:39:11,393 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:39:11,393 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:39:14,089 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000252A2675E10>
2022-04-30 21:39:14,090 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000252A2675E10> by query: select 1 from DUAL
2022-04-30 21:39:14,580 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000252A2675E10> successfully checked
2022-04-30 21:39:14,580 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:39:14,581 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 21:39:14,587 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 21:39:14,628 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 21:39:14,629 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 21:39:15,412 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:39:15,418 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1098           ATM   Стерлитамак    г. Стерлитамак, Электрозаводская ул., д. 3
2022-04-30 21:39:15,428 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:39:15,441 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:39:15,454 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:39:15,463 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,463 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:39:15,472 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,472 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:39:15,484 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,485 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:39:15,494 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,494 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:39:15,503 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,504 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:39:15,513 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,513 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:39:15,521 - multiprocessing - INFO - Query performed
2022-04-30 21:39:15,535 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 21:39:15,551 - multiprocessing - INFO - Connection closed
2022-04-30 21:39:15,584 - multiprocessing - INFO - process shutting down
2022-04-30 21:49:13,730 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:49:13,731 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:49:16,704 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000225E41A9E10>
2022-04-30 21:49:16,704 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000225E41A9E10> by query: select 1 from DUAL
2022-04-30 21:49:17,290 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000225E41A9E10> successfully checked
2022-04-30 21:49:17,290 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:49:17,291 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:49:17,493 - multiprocessing - INFO - process shutting down
2022-04-30 21:49:35,428 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:49:35,428 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:49:38,488 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002E501901E10>
2022-04-30 21:49:38,489 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002E501901E10> by query: select 1 from DUAL
2022-04-30 21:49:39,034 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002E501901E10> successfully checked
2022-04-30 21:49:39,035 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:49:39,036 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:49:39,042 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:49:39,065 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:49:39,065 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 21:49:39,066 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 21:49:39,130 - multiprocessing - INFO - process shutting down
2022-04-30 21:49:58,753 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:49:58,753 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:50:01,588 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001D698A69E10>
2022-04-30 21:50:01,588 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001D698A69E10> by query: select 1 from DUAL
2022-04-30 21:50:02,077 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001D698A69E10> successfully checked
2022-04-30 21:50:02,078 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:50:02,079 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:50:02,084 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:50:02,123 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:50:02,123 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 21:50:02,123 - multiprocessing - INFO - Maxdate <= date_from_metadata! No actual data to insert! No dataframe will be created, exit function "terminals_to_staging"
2022-04-30 21:50:02,154 - multiprocessing - INFO - process shutting down
2022-04-30 21:50:13,315 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:50:13,315 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:50:16,326 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002C909335E10>
2022-04-30 21:50:16,327 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002C909335E10> by query: select 1 from DUAL
2022-04-30 21:50:16,751 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002C909335E10> successfully checked
2022-04-30 21:50:16,751 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:50:16,752 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:50:16,757 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:50:16,780 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:50:16,780 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:50:17,798 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:50:17,803 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:50:17,821 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: list.count() takes exactly one argument (0 given)
2022-04-30 21:50:17,821 - multiprocessing - INFO - ETL-process stopped
2022-04-30 21:50:17,846 - multiprocessing - INFO - process shutting down
2022-04-30 21:53:26,718 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:53:26,719 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:53:29,838 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021406EA9E10>
2022-04-30 21:53:29,838 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021406EA9E10> by query: select 1 from DUAL
2022-04-30 21:53:30,443 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021406EA9E10> successfully checked
2022-04-30 21:53:30,443 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:53:30,444 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:53:30,450 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:53:30,492 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:53:30,492 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:53:31,450 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:53:31,457 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:53:31,474 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: 'list' object has no attribute 'to_string'
2022-04-30 21:53:31,475 - multiprocessing - INFO - ETL-process stopped
2022-04-30 21:53:31,553 - multiprocessing - INFO - process shutting down
2022-04-30 21:54:01,535 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:54:01,535 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:54:04,692 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001A6D5709E10>
2022-04-30 21:54:04,693 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001A6D5709E10> by query: select 1 from DUAL
2022-04-30 21:54:05,081 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001A6D5709E10> successfully checked
2022-04-30 21:54:05,081 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:54:05,082 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:54:05,087 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:54:05,110 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:54:05,110 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:54:05,979 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:54:05,983 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:54:05,997 - multiprocessing - INFO - df_source: []
2022-04-30 21:54:06,050 - multiprocessing - INFO - Function "terminals_to_staging" failed with Exception: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2022-04-30 21:54:06,051 - multiprocessing - INFO - ETL-process stopped
2022-04-30 21:54:06,081 - multiprocessing - INFO - process shutting down
2022-04-30 21:54:21,556 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 21:54:21,557 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 21:54:24,375 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000018859729E10>
2022-04-30 21:54:24,375 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000018859729E10> by query: select 1 from DUAL
2022-04-30 21:54:24,845 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000018859729E10> successfully checked
2022-04-30 21:54:24,845 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 21:54:24,846 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 21:54:24,850 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 21:54:24,871 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 21:54:24,871 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 21:54:25,532 - multiprocessing - INFO - Created dataframe:
2022-04-30 21:54:25,537 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 21:54:25,552 - multiprocessing - INFO - df_source: []
2022-04-30 21:54:25,560 - multiprocessing - INFO - Staging was cleared!
2022-04-30 21:54:25,570 - multiprocessing - INFO - Data was inserted!
2022-04-30 21:54:25,589 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 21:54:25,595 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,595 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals
            
2022-04-30 21:54:25,601 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,601 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 21:54:25,609 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,609 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 21:54:25,617 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,617 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 21:54:25,745 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 21:54:25,788 - multiprocessing - INFO - Rollback performed!
2022-04-30 21:54:25,788 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 21:54:25,795 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,795 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 21:54:25,804 - multiprocessing - INFO - Query performed
2022-04-30 21:54:25,822 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 21:54:25,835 - multiprocessing - INFO - Connection closed
2022-04-30 21:54:25,894 - multiprocessing - INFO - process shutting down
2022-04-30 22:17:41,685 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:17:41,685 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:17:44,505 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021F53EB9E10>
2022-04-30 22:17:44,505 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021F53EB9E10> by query: select 1 from DUAL
2022-04-30 22:17:44,916 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021F53EB9E10> successfully checked
2022-04-30 22:17:44,916 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:17:44,917 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 22:17:44,923 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 22:17:44,950 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 22:17:44,950 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 22:17:45,623 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:17:45,628 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 22:17:45,643 - multiprocessing - INFO - Source is empty. First filling of the source...
2022-04-30 22:17:45,767 - multiprocessing - INFO - Data was not inserted into demipt2.gold_stg_dim_terminals_source (first load)! Exception: java.sql.BatchUpdateException: ORA-01536: превышена квота памяти для раздела 'USERS'

2022-04-30 22:17:45,767 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:17:45,800 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,800 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:17:45,807 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,807 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:17:45,817 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,817 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:17:45,824 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,824 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:17:45,832 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,832 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:17:45,839 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,840 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:17:45,846 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,847 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:17:45,853 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,853 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:17:45,862 - multiprocessing - INFO - Query performed
2022-04-30 22:17:45,862 - multiprocessing - INFO - Updating source...
2022-04-30 22:17:45,886 - multiprocessing - INFO - Data was not updated in demipt2.gold_stg_dim_terminals_source! Exception: java.sql.BatchUpdateException: ORA-01536: превышена квота памяти для раздела 'USERS'

2022-04-30 22:17:45,900 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 22:17:45,912 - multiprocessing - INFO - Connection closed
2022-04-30 22:17:45,970 - multiprocessing - INFO - process shutting down
2022-04-30 22:19:27,112 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:19:27,112 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:19:30,154 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000025D9F315E10>
2022-04-30 22:19:30,155 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000025D9F315E10> by query: select 1 from DUAL
2022-04-30 22:19:30,672 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000025D9F315E10> successfully checked
2022-04-30 22:19:30,672 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:19:30,673 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:19:30,728 - multiprocessing - INFO - process shutting down
2022-04-30 22:19:50,490 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:19:50,491 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:19:53,579 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024F681A5E10>
2022-04-30 22:19:53,579 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024F681A5E10> by query: select 1 from DUAL
2022-04-30 22:19:54,047 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024F681A5E10> successfully checked
2022-04-30 22:19:54,047 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:19:54,048 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 22:19:54,066 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 22:19:54,103 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 22:19:54,104 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 22:19:55,050 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:19:55,056 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 22:19:55,072 - multiprocessing - INFO - Source is empty. First filling of the source...
2022-04-30 22:19:55,241 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:19:55,241 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:19:55,251 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,252 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:19:55,261 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,262 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:19:55,275 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,275 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:19:55,286 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,286 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:19:55,300 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,301 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:19:55,315 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,316 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:19:55,326 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,326 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:19:55,335 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,336 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:19:55,346 - multiprocessing - INFO - Query performed
2022-04-30 22:19:55,347 - multiprocessing - INFO - Updating source...
2022-04-30 22:19:55,356 - multiprocessing - INFO - Data was updated in demipt2.gold_stg_dim_terminals_source
2022-04-30 22:19:55,373 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 22:19:55,386 - multiprocessing - INFO - Connection closed
2022-04-30 22:19:55,397 - multiprocessing - INFO - process shutting down
2022-04-30 22:23:12,526 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:23:12,526 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:23:15,756 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002164FC2DE10>
2022-04-30 22:23:15,757 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002164FC2DE10> by query: select 1 from DUAL
2022-04-30 22:23:16,287 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002164FC2DE10> successfully checked
2022-04-30 22:23:16,287 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:23:16,289 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 22:23:16,294 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 22:23:16,335 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 22:23:16,335 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 22:23:18,066 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:23:18,070 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 22:23:18,084 - multiprocessing - INFO - Source is empty. First filling of the source...
2022-04-30 22:23:18,094 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:23:18,094 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:23:18,101 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,101 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:23:18,107 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,107 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:23:18,114 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,114 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:23:18,121 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,121 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:23:18,129 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,129 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:23:18,137 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,137 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:23:18,144 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,144 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:23:18,151 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,151 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:23:18,158 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,158 - multiprocessing - INFO - Making SQL-query:

        delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:23:18,166 - multiprocessing - INFO - Query performed
2022-04-30 22:23:18,166 - multiprocessing - INFO - Updating source...
2022-04-30 22:23:18,173 - multiprocessing - INFO - Data was updated in demipt2.gold_stg_dim_terminals_source
2022-04-30 22:23:18,189 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 22:23:18,209 - multiprocessing - INFO - Connection closed
2022-04-30 22:23:18,220 - multiprocessing - INFO - process shutting down
2022-04-30 22:24:45,927 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:24:45,927 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:24:48,790 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000019DAAED5E10>
2022-04-30 22:24:48,790 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000019DAAED5E10> by query: select 1 from DUAL
2022-04-30 22:24:49,221 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000019DAAED5E10> successfully checked
2022-04-30 22:24:49,222 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:24:49,223 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 22:24:49,227 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 22:24:49,251 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 22:24:49,251 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 22:24:50,405 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:24:50,411 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:24:50,430 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:24:50,440 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,440 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:24:50,449 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,449 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:24:50,458 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,458 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:24:50,467 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,467 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:24:50,477 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,477 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:24:50,487 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,487 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:24:50,497 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,497 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:24:50,506 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,506 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:24:50,515 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,516 - multiprocessing - INFO - Making SQL-query:

        delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:24:50,525 - multiprocessing - INFO - Query performed
2022-04-30 22:24:50,525 - multiprocessing - INFO - Updating source...
2022-04-30 22:24:50,541 - multiprocessing - INFO - Data was updated in demipt2.gold_stg_dim_terminals_source
2022-04-30 22:24:50,556 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 22:24:50,571 - multiprocessing - INFO - Connection closed
2022-04-30 22:24:50,582 - multiprocessing - INFO - process shutting down
2022-04-30 22:33:29,827 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:33:29,828 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:33:33,471 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002016E465E10>
2022-04-30 22:33:33,472 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002016E465E10> by query: select 1 from DUAL
2022-04-30 22:33:34,140 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002016E465E10> successfully checked
2022-04-30 22:33:34,141 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:33:34,142 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 22:33:34,147 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 22:33:34,170 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 22:33:34,170 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 22:33:34,679 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:33:34,683 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 22:33:34,694 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:33:34,694 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:33:34,700 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,701 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:33:34,707 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,707 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:33:34,714 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,714 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:33:34,720 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,720 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:33:34,727 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,728 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:33:34,739 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,739 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:33:34,745 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,745 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:33:34,752 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,753 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:33:34,759 - multiprocessing - INFO - Query performed
2022-04-30 22:33:34,780 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_01032021.xlsx.backup'
2022-04-30 22:33:34,791 - multiprocessing - INFO - Connection closed
2022-04-30 22:33:34,803 - multiprocessing - INFO - process shutting down
2022-04-30 22:34:06,280 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:34:06,281 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:34:09,126 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001C0754B5E10>
2022-04-30 22:34:09,126 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001C0754B5E10> by query: select 1 from DUAL
2022-04-30 22:34:09,627 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001C0754B5E10> successfully checked
2022-04-30 22:34:09,628 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:34:09,629 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 22:34:09,634 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 22:34:09,677 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 22:34:09,677 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 22:34:10,509 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:34:10,515 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:34:10,529 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:34:10,530 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:34:10,540 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,541 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:34:10,550 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,551 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:34:10,561 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,561 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:34:10,570 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,570 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:34:10,581 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,581 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:34:10,591 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,592 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:34:10,601 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,601 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:34:10,611 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,612 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:34:10,621 - multiprocessing - INFO - Query performed
2022-04-30 22:34:10,653 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_02032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_02032021.xlsx.backup'
2022-04-30 22:34:10,671 - multiprocessing - INFO - Connection closed
2022-04-30 22:34:10,692 - multiprocessing - INFO - process shutting down
2022-04-30 22:38:07,113 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:38:07,114 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:38:10,803 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001D416AD9E10>
2022-04-30 22:38:10,803 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001D416AD9E10> by query: select 1 from DUAL
2022-04-30 22:38:11,290 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001D416AD9E10> successfully checked
2022-04-30 22:38:11,290 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:38:11,292 - multiprocessing - INFO - List of files for processing: ['terminals_01032021.xlsx']
2022-04-30 22:38:11,296 - multiprocessing - INFO - The actual file: terminals_01032021.xlsx
2022-04-30 22:38:11,319 - multiprocessing - INFO - Actual date: 2021-03-01
2022-04-30 22:38:11,320 - multiprocessing - INFO - Date from metadata: 1900-01-01
2022-04-30 22:38:12,600 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:38:12,606 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 22:38:12,606 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:38:12,617 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,631 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:38:12,631 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:38:12,639 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,639 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:38:12,648 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,648 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:38:12,657 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,657 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:38:12,665 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,666 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:38:12,675 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,676 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:38:12,685 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,685 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:38:12,693 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,693 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:38:12,703 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,703 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:38:12,712 - multiprocessing - INFO - Query performed
2022-04-30 22:38:12,732 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_01032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_01032021.xlsx
2022-04-30 22:38:12,744 - multiprocessing - INFO - Connection closed
2022-04-30 22:38:12,754 - multiprocessing - INFO - process shutting down
2022-04-30 22:38:55,089 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:38:55,089 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:38:58,281 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001834CEC1E10>
2022-04-30 22:38:58,281 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001834CEC1E10> by query: select 1 from DUAL
2022-04-30 22:38:58,896 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001834CEC1E10> successfully checked
2022-04-30 22:38:58,897 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:38:58,897 - multiprocessing - INFO - List of files for processing: ['terminals_02032021.xlsx']
2022-04-30 22:38:58,903 - multiprocessing - INFO - The actual file: terminals_02032021.xlsx
2022-04-30 22:38:58,928 - multiprocessing - INFO - Actual date: 2021-03-02
2022-04-30 22:38:58,928 - multiprocessing - INFO - Date from metadata: 2021-03-01
2022-04-30 22:38:59,919 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:38:59,926 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:38:59,926 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:39:00,029 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,102 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:39:00,103 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:39:00,109 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,110 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:39:00,116 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,116 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:39:00,124 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,124 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:39:00,130 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,130 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:39:00,139 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,140 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:39:00,147 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,147 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:39:00,155 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,155 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:39:00,166 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,166 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:39:00,173 - multiprocessing - INFO - Query performed
2022-04-30 22:39:00,198 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_02032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_02032021.xlsx
2022-04-30 22:39:00,211 - multiprocessing - INFO - Connection closed
2022-04-30 22:39:00,231 - multiprocessing - INFO - process shutting down
2022-04-30 22:43:35,878 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:43:35,878 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:43:39,220 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002765BEB9E10>
2022-04-30 22:43:39,220 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002765BEB9E10> by query: select 1 from DUAL
2022-04-30 22:43:40,057 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002765BEB9E10> successfully checked
2022-04-30 22:43:40,057 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:43:40,058 - multiprocessing - INFO - List of files for processing: ['terminals_03032021.xlsx']
2022-04-30 22:43:40,064 - multiprocessing - INFO - The actual file: terminals_03032021.xlsx
2022-04-30 22:43:40,083 - multiprocessing - INFO - Actual date: 2021-03-03
2022-04-30 22:43:40,084 - multiprocessing - INFO - Date from metadata: 2021-03-02
2022-04-30 22:43:40,993 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:43:40,998 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1098           ATM   Стерлитамак    г. Стерлитамак, Электрозаводская ул., д. 3
2022-04-30 22:43:40,998 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:43:41,005 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,017 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:43:41,017 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:43:41,023 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,024 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:43:41,030 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,030 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:43:41,037 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,037 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:43:41,043 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,043 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:43:41,051 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,051 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:43:41,059 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,059 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:43:41,068 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,068 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:43:41,076 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,076 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:43:41,083 - multiprocessing - INFO - Query performed
2022-04-30 22:43:41,094 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_03032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_03032021.xlsx
2022-04-30 22:43:41,106 - multiprocessing - INFO - Connection closed
2022-04-30 22:43:41,117 - multiprocessing - INFO - process shutting down
2022-04-30 22:44:49,127 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:44:49,127 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:44:52,460 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001D838511E10>
2022-04-30 22:44:52,460 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001D838511E10> by query: select 1 from DUAL
2022-04-30 22:44:53,618 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001D838511E10> successfully checked
2022-04-30 22:44:53,618 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:44:53,619 - multiprocessing - INFO - List of files for processing: ['terminals_04032021.xlsx']
2022-04-30 22:44:53,626 - multiprocessing - INFO - The actual file: terminals_04032021.xlsx
2022-04-30 22:44:53,675 - multiprocessing - INFO - Actual date: 2021-03-04
2022-04-30 22:44:53,676 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:44:55,419 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:44:55,428 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1098           ATM   Стерлитамак    г. Стерлитамак, Электрозаводская ул., д. 3
2022-04-30 22:44:55,428 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:44:55,439 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,459 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:44:55,459 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:44:55,468 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,469 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:44:55,477 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,478 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:44:55,488 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,489 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:44:55,498 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,498 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:44:55,510 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,510 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:44:55,522 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,522 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:44:55,532 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,534 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:44:55,546 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,546 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:44:55,555 - multiprocessing - INFO - Query performed
2022-04-30 22:44:55,574 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_04032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_04032021.xlsx
2022-04-30 22:44:55,588 - multiprocessing - INFO - Connection closed
2022-04-30 22:44:55,605 - multiprocessing - INFO - process shutting down
2022-04-30 22:45:53,567 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:45:53,567 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:45:56,747 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001F92D501E10>
2022-04-30 22:45:56,747 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001F92D501E10> by query: select 1 from DUAL
2022-04-30 22:45:57,254 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001F92D501E10> successfully checked
2022-04-30 22:45:57,254 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:45:57,255 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 22:45:57,260 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 22:45:57,302 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 22:45:57,302 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:45:58,168 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:45:58,174 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:45:58,174 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:45:58,184 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,198 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source (first load)!
2022-04-30 22:45:58,199 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:45:58,207 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,207 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:45:58,216 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,217 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:45:58,226 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,226 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:45:58,235 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,235 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:45:58,245 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,245 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:45:58,255 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,255 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:45:58,282 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 22:45:58,307 - multiprocessing - INFO - Rollback performed!
2022-04-30 22:45:58,307 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:45:58,317 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,317 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:45:58,326 - multiprocessing - INFO - Query performed
2022-04-30 22:45:58,340 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_05032021.xlsx
2022-04-30 22:45:58,353 - multiprocessing - INFO - Connection closed
2022-04-30 22:45:58,363 - multiprocessing - INFO - process shutting down
2022-04-30 22:51:57,770 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:51:57,771 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:52:00,858 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000021716379E10>
2022-04-30 22:52:00,859 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000021716379E10> by query: select 1 from DUAL
2022-04-30 22:52:01,571 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000021716379E10> successfully checked
2022-04-30 22:52:01,571 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:52:01,572 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 22:52:01,579 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 22:52:01,602 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 22:52:01,603 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:52:02,225 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:52:02,230 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:52:02,230 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:52:02,254 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,281 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 22:52:02,282 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:52:02,291 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,291 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:52:02,300 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,300 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:52:02,310 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,310 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:52:02,319 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,319 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:52:02,331 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,332 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:52:02,344 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,344 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:52:02,378 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 22:52:02,392 - multiprocessing - INFO - Rollback performed!
2022-04-30 22:52:02,393 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:52:02,403 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,403 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:52:02,430 - multiprocessing - INFO - Query performed
2022-04-30 22:52:02,445 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx.backup'
2022-04-30 22:52:02,477 - multiprocessing - INFO - Connection closed
2022-04-30 22:52:02,488 - multiprocessing - INFO - process shutting down
2022-04-30 22:54:02,952 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:54:02,953 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:54:05,975 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000026DB6EB5E10>
2022-04-30 22:54:05,976 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000026DB6EB5E10> by query: select 1 from DUAL
2022-04-30 22:54:06,456 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000026DB6EB5E10> successfully checked
2022-04-30 22:54:06,456 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:54:06,457 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 22:54:06,463 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 22:54:06,503 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 22:54:06,504 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:54:07,650 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:54:07,655 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:54:07,655 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:54:07,662 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,677 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 22:54:07,678 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:54:07,684 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,684 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:54:07,690 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,690 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:54:07,697 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,697 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:54:07,703 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,703 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:54:07,710 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,711 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:54:07,717 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,717 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:54:07,739 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 22:54:07,759 - multiprocessing - INFO - Rollback performed!
2022-04-30 22:54:07,759 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:54:07,765 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,765 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:54:07,773 - multiprocessing - INFO - Query performed
2022-04-30 22:54:07,784 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx.backup'
2022-04-30 22:54:07,797 - multiprocessing - INFO - Connection closed
2022-04-30 22:54:07,808 - multiprocessing - INFO - process shutting down
2022-04-30 22:54:47,010 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:54:47,010 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:54:49,911 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000025B154B9E10>
2022-04-30 22:54:49,911 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000025B154B9E10> by query: select 1 from DUAL
2022-04-30 22:54:50,376 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000025B154B9E10> successfully checked
2022-04-30 22:54:50,376 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:54:50,377 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 22:54:50,383 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 22:54:50,405 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 22:54:50,405 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:54:51,106 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:54:51,110 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:54:51,111 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:54:51,117 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,128 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 22:54:51,128 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:54:51,134 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,134 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:54:51,140 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,141 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:54:51,147 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,147 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:54:51,153 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,154 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:54:51,161 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,161 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:54:51,169 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,169 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:54:51,190 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 22:54:51,222 - multiprocessing - INFO - Rollback performed!
2022-04-30 22:54:51,222 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:54:51,228 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,228 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:54:51,235 - multiprocessing - INFO - Query performed
2022-04-30 22:54:51,246 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_05032021.xlsx.backup'
2022-04-30 22:54:51,267 - multiprocessing - INFO - Connection closed
2022-04-30 22:54:51,280 - multiprocessing - INFO - process shutting down
2022-04-30 22:58:57,664 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 22:58:57,665 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 22:59:00,879 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000001BC97621E10>
2022-04-30 22:59:00,879 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000001BC97621E10> by query: select 1 from DUAL
2022-04-30 22:59:01,393 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000001BC97621E10> successfully checked
2022-04-30 22:59:01,393 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 22:59:01,394 - multiprocessing - INFO - List of files for processing: ['terminals_06032021.xlsx']
2022-04-30 22:59:01,400 - multiprocessing - INFO - The actual file: terminals_06032021.xlsx
2022-04-30 22:59:01,441 - multiprocessing - INFO - Actual date: 2021-03-06
2022-04-30 22:59:01,441 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 22:59:02,576 - multiprocessing - INFO - Created dataframe:
2022-04-30 22:59:02,580 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2022-04-30 22:59:02,581 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:59:02,588 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,599 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 22:59:02,600 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 22:59:02,606 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,606 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 22:59:02,612 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,613 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 22:59:02,619 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,619 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 22:59:02,626 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,626 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 22:59:02,633 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,634 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 22:59:02,647 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,647 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 22:59:02,667 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 22:59:02,682 - multiprocessing - INFO - Rollback performed!
2022-04-30 22:59:02,682 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 22:59:02,689 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,689 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 22:59:02,695 - multiprocessing - INFO - Query performed
2022-04-30 22:59:02,705 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_06032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_06032021.xlsx
2022-04-30 22:59:02,716 - multiprocessing - INFO - Connection closed
2022-04-30 22:59:02,727 - multiprocessing - INFO - process shutting down
2022-04-30 23:00:16,195 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:00:16,195 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:00:19,040 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000023101905E10>
2022-04-30 23:00:19,040 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000023101905E10> by query: select 1 from DUAL
2022-04-30 23:00:19,552 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000023101905E10> successfully checked
2022-04-30 23:00:19,553 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:00:19,554 - multiprocessing - INFO - List of files for processing: ['terminals_05032021.xlsx']
2022-04-30 23:00:19,559 - multiprocessing - INFO - The actual file: terminals_05032021.xlsx
2022-04-30 23:00:19,602 - multiprocessing - INFO - Actual date: 2021-03-05
2022-04-30 23:00:19,602 - multiprocessing - INFO - Date from metadata: 2021-03-03
2022-04-30 23:00:20,437 - multiprocessing - INFO - Created dataframe:
2022-04-30 23:00:20,444 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
1       A1097           ATM        Баймак          г. Баймак, Б. Лёвшинский пер., д. 37
2       A1098           ATM          Лала                                      лалалала
3       A1099           ATM       ваапапв                                  вапвапвапвап
2022-04-30 23:00:20,444 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:00:20,452 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,464 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 23:00:20,464 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 23:00:20,472 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,472 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 23:00:20,479 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,480 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 23:00:20,487 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,488 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:00:20,494 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,494 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 23:00:20,503 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,503 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 23:00:20,514 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,514 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 23:00:20,522 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,522 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 23:00:20,530 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,531 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 23:00:20,538 - multiprocessing - INFO - Query performed
2022-04-30 23:00:20,593 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_05032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_05032021.xlsx
2022-04-30 23:00:20,628 - multiprocessing - INFO - Connection closed
2022-04-30 23:00:20,668 - multiprocessing - INFO - process shutting down
2022-04-30 23:05:47,528 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:05:47,529 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:05:50,415 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000214EBDD5E10>
2022-04-30 23:05:50,416 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000214EBDD5E10> by query: select 1 from DUAL
2022-04-30 23:05:50,817 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000214EBDD5E10> successfully checked
2022-04-30 23:05:50,817 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:05:50,818 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:05:50,863 - multiprocessing - INFO - process shutting down
2022-04-30 23:06:04,923 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:06:04,923 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:06:08,001 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x0000024F146F5E10>
2022-04-30 23:06:08,002 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x0000024F146F5E10> by query: select 1 from DUAL
2022-04-30 23:06:08,398 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x0000024F146F5E10> successfully checked
2022-04-30 23:06:08,398 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:06:08,400 - multiprocessing - INFO - List of files for processing: ['terminals_07032021.xlsx']
2022-04-30 23:06:08,405 - multiprocessing - INFO - The actual file: terminals_07032021.xlsx
2022-04-30 23:06:08,433 - multiprocessing - INFO - Actual date: 2021-03-07
2022-04-30 23:06:08,433 - multiprocessing - INFO - Date from metadata: 2021-03-05
2022-04-30 23:06:09,459 - multiprocessing - INFO - Created dataframe:
2022-04-30 23:06:09,465 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 23:06:09,466 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:06:09,476 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,490 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 23:06:09,491 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 23:06:09,501 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,501 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 23:06:09,510 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,511 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 23:06:09,522 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,522 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:06:09,532 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,532 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 23:06:09,550 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,550 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 23:06:09,561 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,562 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 23:06:09,593 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 23:06:09,623 - multiprocessing - INFO - Rollback performed!
2022-04-30 23:06:09,624 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 23:06:09,635 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,635 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 23:06:09,646 - multiprocessing - INFO - Query performed
2022-04-30 23:06:09,659 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_07032021.xlsx was successfully backed up to C:\Users\Ilya\PycharmProjects\GOLD\archive\terminals_07032021.xlsx
2022-04-30 23:06:09,672 - multiprocessing - INFO - Connection closed
2022-04-30 23:06:09,683 - multiprocessing - INFO - process shutting down
2022-04-30 23:08:31,047 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:08:31,047 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:08:33,899 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x00000241507A9E10>
2022-04-30 23:08:33,899 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x00000241507A9E10> by query: select 1 from DUAL
2022-04-30 23:08:34,309 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x00000241507A9E10> successfully checked
2022-04-30 23:08:34,309 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:08:34,311 - multiprocessing - INFO - List of files for processing: ['terminals_07032021.xlsx']
2022-04-30 23:08:34,315 - multiprocessing - INFO - The actual file: terminals_07032021.xlsx
2022-04-30 23:08:34,336 - multiprocessing - INFO - Actual date: 2021-03-07
2022-04-30 23:08:34,337 - multiprocessing - INFO - Date from metadata: 2021-03-05
2022-04-30 23:08:35,382 - multiprocessing - INFO - Created dataframe:
2022-04-30 23:08:35,387 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 23:08:35,388 - multiprocessing - INFO - Making SQL-query:

            drop table demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:08:35,482 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLException: ORA-00054: ресурс занят и задано его получение с параметром NOWAIT, либо истекло время ожидания

2022-04-30 23:08:35,490 - multiprocessing - INFO - Rollback performed!
2022-04-30 23:08:35,490 - multiprocessing - INFO - Making SQL-query:

            create table demipt2.gold_stg_dim_terminals_source (
                terminal_id varchar2(10),
                terminal_type varchar2(10),
                terminal_city varchar2(50),
                terminal_address varchar2(100),
                update_dt date
                )
            
2022-04-30 23:08:35,512 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLSyntaxErrorException: ORA-00955: имя уже задействовано для существующего объекта

2022-04-30 23:08:35,518 - multiprocessing - INFO - Rollback performed!
2022-04-30 23:08:35,530 - multiprocessing - INFO - Data was inserted into demipt2.gold_stg_dim_terminals_source!
2022-04-30 23:08:35,530 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 23:08:35,536 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,536 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 23:08:35,542 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,542 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 23:08:35,549 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,549 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:08:35,555 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,555 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 23:08:35,563 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,564 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 23:08:35,571 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,571 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 23:08:35,578 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,579 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 23:08:35,587 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,587 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 23:08:35,594 - multiprocessing - INFO - Query performed
2022-04-30 23:08:35,606 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_07032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_07032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_07032021.xlsx.backup'
2022-04-30 23:08:35,620 - multiprocessing - INFO - Connection closed
2022-04-30 23:08:35,631 - multiprocessing - INFO - process shutting down
2022-04-30 23:12:44,500 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:12:44,500 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:12:47,569 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002A6241A5E10>
2022-04-30 23:12:47,569 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002A6241A5E10> by query: select 1 from DUAL
2022-04-30 23:12:48,009 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002A6241A5E10> successfully checked
2022-04-30 23:12:48,010 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:12:48,010 - multiprocessing - INFO - No files matching pattern detected. Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:12:48,045 - multiprocessing - INFO - process shutting down
2022-04-30 23:13:00,855 - multiprocessing - INFO - Starting C:\Users\Ilya\PycharmProjects\GOLD/__main__
2022-04-30 23:13:00,855 - multiprocessing - INFO - Connecting to Oracle...
2022-04-30 23:13:04,126 - multiprocessing - INFO - Connection established! Params: <jaydebeapi.Connection object at 0x000002DAA4B75E10>
2022-04-30 23:13:04,126 - multiprocessing - INFO - Checking connection: <jaydebeapi.Connection object at 0x000002DAA4B75E10> by query: select 1 from DUAL
2022-04-30 23:13:04,530 - multiprocessing - INFO - Connection <jaydebeapi.Connection object at 0x000002DAA4B75E10> successfully checked
2022-04-30 23:13:04,530 - multiprocessing - INFO - Start parsing data about Terminals. Path: C:\Users\Ilya\PycharmProjects\GOLD Pattern: terminals_[0-9]+.\.xlsx
2022-04-30 23:13:04,531 - multiprocessing - INFO - List of files for processing: ['terminals_07032021.xlsx']
2022-04-30 23:13:04,536 - multiprocessing - INFO - The actual file: terminals_07032021.xlsx
2022-04-30 23:13:04,585 - multiprocessing - INFO - Actual date: 2021-03-07
2022-04-30 23:13:04,585 - multiprocessing - INFO - Date from metadata: 2021-03-05
2022-04-30 23:13:05,767 - multiprocessing - INFO - Created dataframe:
2022-04-30 23:13:05,772 - multiprocessing - INFO - 
  terminal_id terminal_type terminal_city                              terminal_address
0       A1096           ATM      Кемерово  г. Кемерово, 1-й Электрозаводский пер., д. 3
2022-04-30 23:13:05,772 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:13:05,781 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,783 - multiprocessing - INFO - Data was not inserted into demipt2.gold_stg_dim_terminals_source! Exception: No matching overloads found for oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,list), options are:
	public void oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,java.lang.Object,int,int) throws java.sql.SQLException
	public void oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,java.lang.Object,int) throws java.sql.SQLException
	public void oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,java.lang.Object) throws java.sql.SQLException
	public void oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,java.lang.Object,java.sql.SQLType,int) throws java.sql.SQLException
	public void oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(int,java.lang.Object,java.sql.SQLType) throws java.sql.SQLException


2022-04-30 23:13:05,783 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals
            
2022-04-30 23:13:05,793 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,793 - multiprocessing - INFO - Making SQL-query:

            delete from demipt2.gold_stg_dim_terminals_del
            
2022-04-30 23:13:05,801 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,802 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_stg_dim_terminals (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            update_dt
        from demipt2.gold_stg_dim_terminals_source
        where 1=0
            or update_dt > (
            select coalesce( last_update_dt, to_date( '1900-01-01', 'YYYY-MM-DD') )
            from demipt2.gold_meta_bank where table_db = 'bank' and table_name = 'terminals' )
            or update_dt is null
            
2022-04-30 23:13:05,810 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,811 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_stg_dim_terminals_del ( terminal_id )
            select terminal_id from demipt2.gold_stg_dim_terminals_source
            
2022-04-30 23:13:05,819 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,819 - multiprocessing - INFO - Making SQL-query:

            merge into demipt2.gold_dwh_dim_terminals_hist tgt
            using (
                select
                    s.terminal_id,
                    s.terminal_type,
                    s.terminal_city,
                    s.terminal_address,
                    s.update_dt,
                    'n' as  deleted_flg,
                    s.update_dt as effective_from,
                    to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
                from demipt2.gold_stg_dim_terminals s
                left join demipt2.gold_dwh_dim_terminals_hist t
                on s.terminal_id = t.terminal_id
                where
                  1=1
                  and t.terminal_id is  null
                  or (
                  t.terminal_id is not null
                  and ( 1 = 0
                        or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                        or (s.terminal_type is not null and t.terminal_type is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                        or (s.terminal_city is not null and t.terminal_city is null)
                      )
                  and ( 1 = 0
                        or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                        or (s.terminal_address is not null and t.terminal_address is null)
                      )
                  )
            ) stg
            on ( tgt.terminal_id = stg.terminal_id )
            when not matched then insert (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
                )
            values (
                stg.terminal_id,
                stg.terminal_type,
                stg.terminal_city,
                stg.terminal_address,
                'n',
                stg.effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd')
                )
            when matched then
            update set effective_to = current_date - interval '1' second
            
2022-04-30 23:13:05,830 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,830 - multiprocessing - INFO - Making SQL-query:

            insert into demipt2.gold_dwh_dim_terminals_hist (
                terminal_id,
                terminal_type,
                terminal_city,
                terminal_address,
                deleted_flg,
                effective_from,
                effective_to
            )
            select
                s.terminal_id,
                s.terminal_type,
                s.terminal_city,
                s.terminal_address,
                'n' as  deleted_flg,
                current_date as effective_from,
                to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
            from demipt2.gold_stg_dim_terminals s
            left join demipt2.gold_dwh_dim_terminals_hist t
            on s.terminal_id = t.terminal_id
            where
              1=1
              and t.terminal_id is  null
              or (
              t.terminal_id is not null
              and ( 1 = 0
                    or (s.terminal_type <> t.terminal_type) or (s.terminal_type is null and t.terminal_type is not null)
                    or (s.terminal_type is not null and t.terminal_type is null)
                  )
              and ( 1 = 0
                    or (s.terminal_city <> t.terminal_city) or (s.terminal_city is null and t.terminal_city is not null)
                    or (s.terminal_city is not null and t.terminal_city is null)
                  )
              and ( 1 = 0
                    or (s.terminal_address <> t.terminal_address) or (s.terminal_address is null and t.terminal_address is not null)
                    or (s.terminal_address is not null and t.terminal_address is null)
                  )
              )
            and effective_to <> to_date( '9999-01-01', 'yyyy-mm-dd')
                    
2022-04-30 23:13:05,841 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,841 - multiprocessing - INFO - Making SQL-query:

        insert into demipt2.gold_dwh_dim_terminals_hist (
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            deleted_flg,
            effective_from,
            effective_to
            )
        select
            terminal_id,
            terminal_type,
            terminal_city,
            terminal_address,
            'y' as deleted_flg,
            current_date as effective_from,
            to_date( '9999-01-01', 'yyyy-mm-dd') as effective_to
        from demipt2.gold_dwh_dim_terminals_hist
        where terminal_id in (
            select
                t.terminal_id
            from demipt2.gold_dwh_dim_terminals_hist t
            left join demipt2.gold_stg_dim_terminals_del s
            on t.terminal_id = s.terminal_id
            where s.terminal_id is null
            )
            and deleted_flg = 'n'
            and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
            
2022-04-30 23:13:05,872 - multiprocessing - INFO - Failed to perform query with Exception java.sql.SQLIntegrityConstraintViolationException: ORA-00001: нарушено ограничение уникальности (DEMIPT2.SYS_C00106480)

2022-04-30 23:13:05,883 - multiprocessing - INFO - Rollback performed!
2022-04-30 23:13:05,884 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_dwh_dim_terminals_hist
        set effective_to = current_date - interval '1' second
        where terminal_id in (
        select
            t.terminal_id
        from demipt2.gold_dwh_dim_terminals_hist t
        left join demipt2.gold_stg_dim_terminals_del s
        on t.terminal_id = s.terminal_id
        where s.terminal_id is null
        )
        and deleted_flg = 'n'
        and effective_to = to_date( '9999-01-01', 'yyyy-mm-dd')
        
2022-04-30 23:13:05,893 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,894 - multiprocessing - INFO - Making SQL-query:

        update demipt2.gold_meta_bank
        set last_update_dt = ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist )
        where table_db = 'bank' and table_name = 'terminals' and ( select max(effective_from) from demipt2.gold_dwh_dim_terminals_hist ) is not null
    
2022-04-30 23:13:05,903 - multiprocessing - INFO - Query performed
2022-04-30 23:13:05,934 - multiprocessing - INFO - File C:\Users\Ilya\PycharmProjects\GOLD\terminals_07032021.xlsx wasn't backed up with Exception [WinError 183] Невозможно создать файл, так как он уже существует: 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_07032021.xlsx' -> 'C:\\Users\\Ilya\\PycharmProjects\\GOLD\\archive\\terminals_07032021.xlsx.backup'
2022-04-30 23:13:05,949 - multiprocessing - INFO - Connection closed
2022-04-30 23:13:05,961 - multiprocessing - INFO - process shutting down
